This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.gitignore
components.json
eslint.config.js
index.html
package.json
README.md
src/api/api.ts
src/App.tsx
src/components/ui/avatar.tsx
src/components/ui/badge.tsx
src/components/ui/button.tsx
src/components/ui/card.tsx
src/components/ui/collapsible.tsx
src/components/ui/dropdown-menu.tsx
src/components/ui/input.tsx
src/components/ui/label.tsx
src/components/ui/select.tsx
src/components/ui/separator.tsx
src/components/ui/sheet.tsx
src/components/ui/sidebar.tsx
src/components/ui/skeleton.tsx
src/components/ui/sonner.tsx
src/components/ui/table.tsx
src/components/ui/tooltip.tsx
src/config/sidebar.config.ts
src/features/auth/components/LoginCard.tsx
src/features/auth/components/LoginCardContent.tsx
src/features/auth/components/LoginCardFooter.tsx
src/features/auth/components/LoginCardHeader.tsx
src/features/auth/components/LoginEmailInput.tsx
src/features/auth/components/LoginPasswordInput.tsx
src/features/auth/hooks/useLogin.ts
src/features/managers/components/ManagerAccordion.tsx
src/features/managers/components/ManagerColumns.tsx
src/features/managers/components/ManagerForm.tsx
src/features/managers/hooks/useManagerConfig.ts
src/features/managers/hooks/useManagerData.ts
src/features/managers/hooks/useManagerMutation.ts
src/hooks/use-mobile.ts
src/index.css
src/lib/authUtils.ts
src/lib/utils.ts
src/main.tsx
src/shared/components/provider/ThemeProvider.tsx
src/shared/components/RequireAuth.tsx
src/shared/components/sidebar/AppSidebar.tsx
src/shared/components/sidebar/NavMain.tsx
src/shared/components/sidebar/NavUser.tsx
src/shared/components/sidebar/SidebarBrand.tsx
src/shared/components/ui/GenericTable.tsx
src/shared/layouts/DashboardLayout.tsx
src/shared/pages/HomePage.tsx
src/shared/pages/LoginPage.tsx
src/shared/pages/ManagerPage.tsx
src/store/authStore.ts
src/store/themeStore.ts
src/types/AssetTypology.ts
src/types/Company.ts
src/types/enums.ts
src/types/EsgData.ts
src/types/ManagedOptions.ts
src/types/Unit.ts
src/types/User.ts
tsconfig.app.json
tsconfig.json
tsconfig.node.json
vite.config.ts
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path=".gitignore">
# Logs
logs
*.log
npm-debug.log*
yarn-debug.log*
yarn-error.log*
pnpm-debug.log*
lerna-debug.log*

node_modules
dist
dist-ssr
*.local

# Editor directories and files
.vscode/*
!.vscode/extensions.json
.idea
.DS_Store
*.suo
*.ntvs*
*.njsproj
*.sln
*.sw?
</file>

<file path="components.json">
{
  "$schema": "https://ui.shadcn.com/schema.json",
  "style": "new-york",
  "rsc": false,
  "tsx": true,
  "tailwind": {
    "config": "",
    "css": "src/index.css",
    "baseColor": "neutral",
    "cssVariables": true,
    "prefix": ""
  },
  "iconLibrary": "lucide",
  "aliases": {
    "components": "@/components",
    "utils": "@/lib/utils",
    "ui": "@/components/ui",
    "lib": "@/lib",
    "hooks": "@/hooks"
  },
  "registries": {}
}
</file>

<file path="eslint.config.js">
import js from '@eslint/js'
import globals from 'globals'
import reactHooks from 'eslint-plugin-react-hooks'
import reactRefresh from 'eslint-plugin-react-refresh'
import tseslint from 'typescript-eslint'
import { defineConfig, globalIgnores } from 'eslint/config'

export default defineConfig([
  globalIgnores(['dist']),
  {
    files: ['**/*.{ts,tsx}'],
    extends: [
      js.configs.recommended,
      tseslint.configs.recommended,
      reactHooks.configs.flat.recommended,
      reactRefresh.configs.vite,
    ],
    languageOptions: {
      ecmaVersion: 2020,
      globals: globals.browser,
    },
  },
])
</file>

<file path="index.html">
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>frontend-react</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
</file>

<file path="package.json">
{
  "name": "frontend-react",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "tsc -b && vite build",
    "lint": "eslint .",
    "preview": "vite preview"
  },
  "dependencies": {
    "@radix-ui/react-avatar": "^1.1.11",
    "@radix-ui/react-collapsible": "^1.1.12",
    "@radix-ui/react-dialog": "^1.1.15",
    "@radix-ui/react-dropdown-menu": "^2.1.16",
    "@radix-ui/react-label": "^2.1.8",
    "@radix-ui/react-select": "^2.2.6",
    "@radix-ui/react-separator": "^1.1.8",
    "@radix-ui/react-slot": "^1.2.4",
    "@radix-ui/react-tooltip": "^1.2.8",
    "@tailwindcss/vite": "^4.1.18",
    "@tanstack/react-query": "^5.90.16",
    "@tanstack/react-table": "^8.21.3",
    "axios": "^1.13.2",
    "class-variance-authority": "^0.7.1",
    "clsx": "^2.1.1",
    "lucide-react": "^0.562.0",
    "next-themes": "^0.4.6",
    "react": "^19.2.0",
    "react-dom": "^19.2.0",
    "react-hook-form": "^7.71.0",
    "sonner": "^2.0.7",
    "tailwind-merge": "^3.4.0",
    "tailwindcss": "^4.1.18",
    "wouter": "^3.9.0",
    "zustand": "^5.0.9"
  },
  "devDependencies": {
    "@eslint/js": "^9.39.1",
    "@types/node": "^24.10.4",
    "@types/react": "^19.2.5",
    "@types/react-dom": "^19.2.3",
    "@vitejs/plugin-react": "^5.1.1",
    "eslint": "^9.39.1",
    "eslint-plugin-react-hooks": "^7.0.1",
    "eslint-plugin-react-refresh": "^0.4.24",
    "globals": "^16.5.0",
    "tw-animate-css": "^1.4.0",
    "typescript": "~5.9.3",
    "typescript-eslint": "^8.46.4",
    "vite": "npm:rolldown-vite@7.2.5"
  },
  "overrides": {
    "vite": "npm:rolldown-vite@7.2.5"
  }
}
</file>

<file path="README.md">
# React + TypeScript + Vite

This template provides a minimal setup to get React working in Vite with HMR and some ESLint rules.

Currently, two official plugins are available:

- [@vitejs/plugin-react](https://github.com/vitejs/vite-plugin-react/blob/main/packages/plugin-react) uses [Babel](https://babeljs.io/) (or [oxc](https://oxc.rs) when used in [rolldown-vite](https://vite.dev/guide/rolldown)) for Fast Refresh
- [@vitejs/plugin-react-swc](https://github.com/vitejs/vite-plugin-react/blob/main/packages/plugin-react-swc) uses [SWC](https://swc.rs/) for Fast Refresh

## React Compiler

The React Compiler is not enabled on this template because of its impact on dev & build performances. To add it, see [this documentation](https://react.dev/learn/react-compiler/installation).

## Expanding the ESLint configuration

If you are developing a production application, we recommend updating the configuration to enable type-aware lint rules:

```js
export default defineConfig([
  globalIgnores(['dist']),
  {
    files: ['**/*.{ts,tsx}'],
    extends: [
      // Other configs...

      // Remove tseslint.configs.recommended and replace with this
      tseslint.configs.recommendedTypeChecked,
      // Alternatively, use this for stricter rules
      tseslint.configs.strictTypeChecked,
      // Optionally, add this for stylistic rules
      tseslint.configs.stylisticTypeChecked,

      // Other configs...
    ],
    languageOptions: {
      parserOptions: {
        project: ['./tsconfig.node.json', './tsconfig.app.json'],
        tsconfigRootDir: import.meta.dirname,
      },
      // other options...
    },
  },
])
```

You can also install [eslint-plugin-react-x](https://github.com/Rel1cx/eslint-react/tree/main/packages/plugins/eslint-plugin-react-x) and [eslint-plugin-react-dom](https://github.com/Rel1cx/eslint-react/tree/main/packages/plugins/eslint-plugin-react-dom) for React-specific lint rules:

```js
// eslint.config.js
import reactX from 'eslint-plugin-react-x'
import reactDom from 'eslint-plugin-react-dom'

export default defineConfig([
  globalIgnores(['dist']),
  {
    files: ['**/*.{ts,tsx}'],
    extends: [
      // Other configs...
      // Enable lint rules for React
      reactX.configs['recommended-typescript'],
      // Enable lint rules for React DOM
      reactDom.configs.recommended,
    ],
    languageOptions: {
      parserOptions: {
        project: ['./tsconfig.node.json', './tsconfig.app.json'],
        tsconfigRootDir: import.meta.dirname,
      },
      // other options...
    },
  },
])
```
</file>

<file path="src/api/api.ts">
import axios from "axios";
import { useAuthStore } from "@/store/authStore.ts";

const BASE_URL = 'http://localhost:8080/api'

const api = axios.create({
    baseURL: BASE_URL,
});

api.interceptors.request.use((config) => {
    const token = useAuthStore.getState().token;

    if (token) {
        config.headers.Authorization = `Bearer ${token}`;
    }
    return config;
});

api.interceptors.response.use(
    (response) => response, // Return successful responses as is
    (error) => {
        // If the error is 401 (Unauthorized)
        if (error.response?.status === 401) {
            // Force logout directly from the store
            useAuthStore.getState().logout();
        }
        return Promise.reject(error);
    }
);

export default api;
</file>

<file path="src/App.tsx">
import { Route, Switch } from "wouter";
import { QueryClient, QueryClientProvider } from "@tanstack/react-query";
import { useEffect } from "react";
import { useAuthStore } from "@/store/authStore";

// Pages
import LoginPage from "@/shared/pages/LoginPage";
import HomePage from "@/shared/pages/HomePage";
import ManagerPage from "@/shared/pages/ManagerPage"; // The Generic Body
import { RequireAuth } from "@/shared/components/RequireAuth";
import DashboardLayout from "@/shared/layouts/DashboardLayout";
import { Toaster } from "@/components/ui/sonner.tsx";

const queryClient = new QueryClient();

function App() {
    const checkSession = useAuthStore((state) => state.checkSession);

    useEffect(() => {
        checkSession();
    }, [checkSession]);

    return (
        <div className="h-screen w-screen">
            <QueryClientProvider client={queryClient}>
                <Switch>
                    {/* Public Routes */}
                    <Route path="/" component={LoginPage} />

                    {/* Protected Routes */}
                    <Route path="/home">
                        <RequireAuth>
                            <HomePage />
                        </RequireAuth>
                    </Route>

                    {/* THE MAGIC ROUTE: Handles Units, Users, and Sources dynamically */}
                    <Route path="/managers/:type">
                        {(_params) => (
                            <RequireAuth>
                                <DashboardLayout>
                                    <ManagerPage />
                                </DashboardLayout>
                            </RequireAuth>
                        )}
                    </Route>

                    {/* Fallback 404 (Optional) */}
                    <Route>404 - Not Found</Route>
                    <Toaster/>
                </Switch>
            </QueryClientProvider>
        </div>
    );
}

export default App;
</file>

<file path="src/components/ui/avatar.tsx">
import * as React from "react"
import * as AvatarPrimitive from "@radix-ui/react-avatar"

import { cn } from "@/lib/utils"

function Avatar({
  className,
  ...props
}: React.ComponentProps<typeof AvatarPrimitive.Root>) {
  return (
    <AvatarPrimitive.Root
      data-slot="avatar"
      className={cn(
        "relative flex size-8 shrink-0 overflow-hidden rounded-full",
        className
      )}
      {...props}
    />
  )
}

function AvatarImage({
  className,
  ...props
}: React.ComponentProps<typeof AvatarPrimitive.Image>) {
  return (
    <AvatarPrimitive.Image
      data-slot="avatar-image"
      className={cn("aspect-square size-full", className)}
      {...props}
    />
  )
}

function AvatarFallback({
  className,
  ...props
}: React.ComponentProps<typeof AvatarPrimitive.Fallback>) {
  return (
    <AvatarPrimitive.Fallback
      data-slot="avatar-fallback"
      className={cn(
        "bg-muted flex size-full items-center justify-center rounded-full",
        className
      )}
      {...props}
    />
  )
}

export { Avatar, AvatarImage, AvatarFallback }
</file>

<file path="src/components/ui/badge.tsx">
import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const badgeVariants = cva(
  "inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",
  {
    variants: {
      variant: {
        default:
          "border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",
        secondary:
          "border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",
        destructive:
          "border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",
        outline:
          "text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

function Badge({
  className,
  variant,
  asChild = false,
  ...props
}: React.ComponentProps<"span"> &
  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {
  const Comp = asChild ? Slot : "span"

  return (
    <Comp
      data-slot="badge"
      className={cn(badgeVariants({ variant }), className)}
      {...props}
    />
  )
}

export { Badge, badgeVariants }
</file>

<file path="src/components/ui/button.tsx">
import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const buttonVariants = cva(
  "inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",
  {
    variants: {
      variant: {
        default: "bg-primary text-primary-foreground hover:bg-primary/90",
        destructive:
          "bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",
        outline:
          "border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",
        secondary:
          "bg-secondary text-secondary-foreground hover:bg-secondary/80",
        ghost:
          "hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",
        link: "text-primary underline-offset-4 hover:underline",
      },
      size: {
        default: "h-9 px-4 py-2 has-[>svg]:px-3",
        sm: "h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",
        lg: "h-10 rounded-md px-6 has-[>svg]:px-4",
        icon: "size-9",
        "icon-sm": "size-8",
        "icon-lg": "size-10",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

function Button({
  className,
  variant = "default",
  size = "default",
  asChild = false,
  ...props
}: React.ComponentProps<"button"> &
  VariantProps<typeof buttonVariants> & {
    asChild?: boolean
  }) {
  const Comp = asChild ? Slot : "button"

  return (
    <Comp
      data-slot="button"
      data-variant={variant}
      data-size={size}
      className={cn(buttonVariants({ variant, size, className }))}
      {...props}
    />
  )
}

export { Button, buttonVariants }
</file>

<file path="src/components/ui/card.tsx">
import * as React from "react"

import { cn } from "@/lib/utils"

function Card({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card"
      className={cn(
        "bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",
        className
      )}
      {...props}
    />
  )
}

function CardHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-header"
      className={cn(
        "@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",
        className
      )}
      {...props}
    />
  )
}

function CardTitle({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-title"
      className={cn("leading-none font-semibold", className)}
      {...props}
    />
  )
}

function CardDescription({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-description"
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

function CardAction({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-action"
      className={cn(
        "col-start-2 row-span-2 row-start-1 self-start justify-self-end",
        className
      )}
      {...props}
    />
  )
}

function CardContent({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-content"
      className={cn("px-6", className)}
      {...props}
    />
  )
}

function CardFooter({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-footer"
      className={cn("flex items-center px-6 [.border-t]:pt-6", className)}
      {...props}
    />
  )
}

export {
  Card,
  CardHeader,
  CardFooter,
  CardTitle,
  CardAction,
  CardDescription,
  CardContent,
}
</file>

<file path="src/components/ui/collapsible.tsx">
import * as CollapsiblePrimitive from "@radix-ui/react-collapsible"

function Collapsible({
  ...props
}: React.ComponentProps<typeof CollapsiblePrimitive.Root>) {
  return <CollapsiblePrimitive.Root data-slot="collapsible" {...props} />
}

function CollapsibleTrigger({
  ...props
}: React.ComponentProps<typeof CollapsiblePrimitive.CollapsibleTrigger>) {
  return (
    <CollapsiblePrimitive.CollapsibleTrigger
      data-slot="collapsible-trigger"
      {...props}
    />
  )
}

function CollapsibleContent({
  ...props
}: React.ComponentProps<typeof CollapsiblePrimitive.CollapsibleContent>) {
  return (
    <CollapsiblePrimitive.CollapsibleContent
      data-slot="collapsible-content"
      {...props}
    />
  )
}

export { Collapsible, CollapsibleTrigger, CollapsibleContent }
</file>

<file path="src/components/ui/dropdown-menu.tsx">
import * as React from "react"
import * as DropdownMenuPrimitive from "@radix-ui/react-dropdown-menu"
import { CheckIcon, ChevronRightIcon, CircleIcon } from "lucide-react"

import { cn } from "@/lib/utils"

function DropdownMenu({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Root>) {
  return <DropdownMenuPrimitive.Root data-slot="dropdown-menu" {...props} />
}

function DropdownMenuPortal({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Portal>) {
  return (
    <DropdownMenuPrimitive.Portal data-slot="dropdown-menu-portal" {...props} />
  )
}

function DropdownMenuTrigger({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Trigger>) {
  return (
    <DropdownMenuPrimitive.Trigger
      data-slot="dropdown-menu-trigger"
      {...props}
    />
  )
}

function DropdownMenuContent({
  className,
  sideOffset = 4,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Content>) {
  return (
    <DropdownMenuPrimitive.Portal>
      <DropdownMenuPrimitive.Content
        data-slot="dropdown-menu-content"
        sideOffset={sideOffset}
        className={cn(
          "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",
          className
        )}
        {...props}
      />
    </DropdownMenuPrimitive.Portal>
  )
}

function DropdownMenuGroup({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Group>) {
  return (
    <DropdownMenuPrimitive.Group data-slot="dropdown-menu-group" {...props} />
  )
}

function DropdownMenuItem({
  className,
  inset,
  variant = "default",
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Item> & {
  inset?: boolean
  variant?: "default" | "destructive"
}) {
  return (
    <DropdownMenuPrimitive.Item
      data-slot="dropdown-menu-item"
      data-inset={inset}
      data-variant={variant}
      className={cn(
        "focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    />
  )
}

function DropdownMenuCheckboxItem({
  className,
  children,
  checked,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.CheckboxItem>) {
  return (
    <DropdownMenuPrimitive.CheckboxItem
      data-slot="dropdown-menu-checkbox-item"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      checked={checked}
      {...props}
    >
      <span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
        <DropdownMenuPrimitive.ItemIndicator>
          <CheckIcon className="size-4" />
        </DropdownMenuPrimitive.ItemIndicator>
      </span>
      {children}
    </DropdownMenuPrimitive.CheckboxItem>
  )
}

function DropdownMenuRadioGroup({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.RadioGroup>) {
  return (
    <DropdownMenuPrimitive.RadioGroup
      data-slot="dropdown-menu-radio-group"
      {...props}
    />
  )
}

function DropdownMenuRadioItem({
  className,
  children,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.RadioItem>) {
  return (
    <DropdownMenuPrimitive.RadioItem
      data-slot="dropdown-menu-radio-item"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    >
      <span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
        <DropdownMenuPrimitive.ItemIndicator>
          <CircleIcon className="size-2 fill-current" />
        </DropdownMenuPrimitive.ItemIndicator>
      </span>
      {children}
    </DropdownMenuPrimitive.RadioItem>
  )
}

function DropdownMenuLabel({
  className,
  inset,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Label> & {
  inset?: boolean
}) {
  return (
    <DropdownMenuPrimitive.Label
      data-slot="dropdown-menu-label"
      data-inset={inset}
      className={cn(
        "px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",
        className
      )}
      {...props}
    />
  )
}

function DropdownMenuSeparator({
  className,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Separator>) {
  return (
    <DropdownMenuPrimitive.Separator
      data-slot="dropdown-menu-separator"
      className={cn("bg-border -mx-1 my-1 h-px", className)}
      {...props}
    />
  )
}

function DropdownMenuShortcut({
  className,
  ...props
}: React.ComponentProps<"span">) {
  return (
    <span
      data-slot="dropdown-menu-shortcut"
      className={cn(
        "text-muted-foreground ml-auto text-xs tracking-widest",
        className
      )}
      {...props}
    />
  )
}

function DropdownMenuSub({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Sub>) {
  return <DropdownMenuPrimitive.Sub data-slot="dropdown-menu-sub" {...props} />
}

function DropdownMenuSubTrigger({
  className,
  inset,
  children,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.SubTrigger> & {
  inset?: boolean
}) {
  return (
    <DropdownMenuPrimitive.SubTrigger
      data-slot="dropdown-menu-sub-trigger"
      data-inset={inset}
      className={cn(
        "focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    >
      {children}
      <ChevronRightIcon className="ml-auto size-4" />
    </DropdownMenuPrimitive.SubTrigger>
  )
}

function DropdownMenuSubContent({
  className,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.SubContent>) {
  return (
    <DropdownMenuPrimitive.SubContent
      data-slot="dropdown-menu-sub-content"
      className={cn(
        "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-lg",
        className
      )}
      {...props}
    />
  )
}

export {
  DropdownMenu,
  DropdownMenuPortal,
  DropdownMenuTrigger,
  DropdownMenuContent,
  DropdownMenuGroup,
  DropdownMenuLabel,
  DropdownMenuItem,
  DropdownMenuCheckboxItem,
  DropdownMenuRadioGroup,
  DropdownMenuRadioItem,
  DropdownMenuSeparator,
  DropdownMenuShortcut,
  DropdownMenuSub,
  DropdownMenuSubTrigger,
  DropdownMenuSubContent,
}
</file>

<file path="src/components/ui/input.tsx">
import * as React from "react"

import { cn } from "@/lib/utils"

function Input({ className, type, ...props }: React.ComponentProps<"input">) {
  return (
    <input
      type={type}
      data-slot="input"
      className={cn(
        "file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",
        "focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]",
        "aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",
        className
      )}
      {...props}
    />
  )
}

export { Input }
</file>

<file path="src/components/ui/label.tsx">
import * as React from "react"
import * as LabelPrimitive from "@radix-ui/react-label"

import { cn } from "@/lib/utils"

function Label({
  className,
  ...props
}: React.ComponentProps<typeof LabelPrimitive.Root>) {
  return (
    <LabelPrimitive.Root
      data-slot="label"
      className={cn(
        "flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",
        className
      )}
      {...props}
    />
  )
}

export { Label }
</file>

<file path="src/components/ui/select.tsx">
import * as React from "react"
import * as SelectPrimitive from "@radix-ui/react-select"
import { CheckIcon, ChevronDownIcon, ChevronUpIcon } from "lucide-react"

import { cn } from "@/lib/utils"

function Select({
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Root>) {
  return <SelectPrimitive.Root data-slot="select" {...props} />
}

function SelectGroup({
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Group>) {
  return <SelectPrimitive.Group data-slot="select-group" {...props} />
}

function SelectValue({
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Value>) {
  return <SelectPrimitive.Value data-slot="select-value" {...props} />
}

function SelectTrigger({
  className,
  size = "default",
  children,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Trigger> & {
  size?: "sm" | "default"
}) {
  return (
    <SelectPrimitive.Trigger
      data-slot="select-trigger"
      data-size={size}
      className={cn(
        "border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    >
      {children}
      <SelectPrimitive.Icon asChild>
        <ChevronDownIcon className="size-4 opacity-50" />
      </SelectPrimitive.Icon>
    </SelectPrimitive.Trigger>
  )
}

function SelectContent({
  className,
  children,
  position = "item-aligned",
  align = "center",
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Content>) {
  return (
    <SelectPrimitive.Portal>
      <SelectPrimitive.Content
        data-slot="select-content"
        className={cn(
          "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",
          position === "popper" &&
            "data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",
          className
        )}
        position={position}
        align={align}
        {...props}
      >
        <SelectScrollUpButton />
        <SelectPrimitive.Viewport
          className={cn(
            "p-1",
            position === "popper" &&
              "h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"
          )}
        >
          {children}
        </SelectPrimitive.Viewport>
        <SelectScrollDownButton />
      </SelectPrimitive.Content>
    </SelectPrimitive.Portal>
  )
}

function SelectLabel({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Label>) {
  return (
    <SelectPrimitive.Label
      data-slot="select-label"
      className={cn("text-muted-foreground px-2 py-1.5 text-xs", className)}
      {...props}
    />
  )
}

function SelectItem({
  className,
  children,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Item>) {
  return (
    <SelectPrimitive.Item
      data-slot="select-item"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",
        className
      )}
      {...props}
    >
      <span
        data-slot="select-item-indicator"
        className="absolute right-2 flex size-3.5 items-center justify-center"
      >
        <SelectPrimitive.ItemIndicator>
          <CheckIcon className="size-4" />
        </SelectPrimitive.ItemIndicator>
      </span>
      <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>
    </SelectPrimitive.Item>
  )
}

function SelectSeparator({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Separator>) {
  return (
    <SelectPrimitive.Separator
      data-slot="select-separator"
      className={cn("bg-border pointer-events-none -mx-1 my-1 h-px", className)}
      {...props}
    />
  )
}

function SelectScrollUpButton({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.ScrollUpButton>) {
  return (
    <SelectPrimitive.ScrollUpButton
      data-slot="select-scroll-up-button"
      className={cn(
        "flex cursor-default items-center justify-center py-1",
        className
      )}
      {...props}
    >
      <ChevronUpIcon className="size-4" />
    </SelectPrimitive.ScrollUpButton>
  )
}

function SelectScrollDownButton({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.ScrollDownButton>) {
  return (
    <SelectPrimitive.ScrollDownButton
      data-slot="select-scroll-down-button"
      className={cn(
        "flex cursor-default items-center justify-center py-1",
        className
      )}
      {...props}
    >
      <ChevronDownIcon className="size-4" />
    </SelectPrimitive.ScrollDownButton>
  )
}

export {
  Select,
  SelectContent,
  SelectGroup,
  SelectItem,
  SelectLabel,
  SelectScrollDownButton,
  SelectScrollUpButton,
  SelectSeparator,
  SelectTrigger,
  SelectValue,
}
</file>

<file path="src/components/ui/separator.tsx">
import * as React from "react"
import * as SeparatorPrimitive from "@radix-ui/react-separator"

import { cn } from "@/lib/utils"

function Separator({
  className,
  orientation = "horizontal",
  decorative = true,
  ...props
}: React.ComponentProps<typeof SeparatorPrimitive.Root>) {
  return (
    <SeparatorPrimitive.Root
      data-slot="separator"
      decorative={decorative}
      orientation={orientation}
      className={cn(
        "bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",
        className
      )}
      {...props}
    />
  )
}

export { Separator }
</file>

<file path="src/components/ui/sheet.tsx">
"use client"

import * as React from "react"
import * as SheetPrimitive from "@radix-ui/react-dialog"
import { XIcon } from "lucide-react"

import { cn } from "@/lib/utils"

function Sheet({ ...props }: React.ComponentProps<typeof SheetPrimitive.Root>) {
  return <SheetPrimitive.Root data-slot="sheet" {...props} />
}

function SheetTrigger({
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Trigger>) {
  return <SheetPrimitive.Trigger data-slot="sheet-trigger" {...props} />
}

function SheetClose({
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Close>) {
  return <SheetPrimitive.Close data-slot="sheet-close" {...props} />
}

function SheetPortal({
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Portal>) {
  return <SheetPrimitive.Portal data-slot="sheet-portal" {...props} />
}

function SheetOverlay({
  className,
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Overlay>) {
  return (
    <SheetPrimitive.Overlay
      data-slot="sheet-overlay"
      className={cn(
        "data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",
        className
      )}
      {...props}
    />
  )
}

function SheetContent({
  className,
  children,
  side = "right",
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Content> & {
  side?: "top" | "right" | "bottom" | "left"
}) {
  return (
    <SheetPortal>
      <SheetOverlay />
      <SheetPrimitive.Content
        data-slot="sheet-content"
        className={cn(
          "bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",
          side === "right" &&
            "data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm",
          side === "left" &&
            "data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",
          side === "top" &&
            "data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b",
          side === "bottom" &&
            "data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",
          className
        )}
        {...props}
      >
        {children}
        <SheetPrimitive.Close className="ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none">
          <XIcon className="size-4" />
          <span className="sr-only">Close</span>
        </SheetPrimitive.Close>
      </SheetPrimitive.Content>
    </SheetPortal>
  )
}

function SheetHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="sheet-header"
      className={cn("flex flex-col gap-1.5 p-4", className)}
      {...props}
    />
  )
}

function SheetFooter({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="sheet-footer"
      className={cn("mt-auto flex flex-col gap-2 p-4", className)}
      {...props}
    />
  )
}

function SheetTitle({
  className,
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Title>) {
  return (
    <SheetPrimitive.Title
      data-slot="sheet-title"
      className={cn("text-foreground font-semibold", className)}
      {...props}
    />
  )
}

function SheetDescription({
  className,
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Description>) {
  return (
    <SheetPrimitive.Description
      data-slot="sheet-description"
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

export {
  Sheet,
  SheetTrigger,
  SheetClose,
  SheetContent,
  SheetHeader,
  SheetFooter,
  SheetTitle,
  SheetDescription,
}
</file>

<file path="src/components/ui/sidebar.tsx">
"use client"

import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"
import { PanelLeftIcon } from "lucide-react"

import { useIsMobile } from "@/hooks/use-mobile"
import { cn } from "@/lib/utils"
import { Button } from "@/components/ui/button"
import { Input } from "@/components/ui/input"
import { Separator } from "@/components/ui/separator"
import {
  Sheet,
  SheetContent,
  SheetDescription,
  SheetHeader,
  SheetTitle,
} from "@/components/ui/sheet"
import { Skeleton } from "@/components/ui/skeleton"
import {
  Tooltip,
  TooltipContent,
  TooltipProvider,
  TooltipTrigger,
} from "@/components/ui/tooltip"

const SIDEBAR_COOKIE_NAME = "sidebar_state"
const SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7
const SIDEBAR_WIDTH = "16rem"
const SIDEBAR_WIDTH_MOBILE = "18rem"
const SIDEBAR_WIDTH_ICON = "3rem"
const SIDEBAR_KEYBOARD_SHORTCUT = "b"

type SidebarContextProps = {
  state: "expanded" | "collapsed"
  open: boolean
  setOpen: (open: boolean) => void
  openMobile: boolean
  setOpenMobile: (open: boolean) => void
  isMobile: boolean
  toggleSidebar: () => void
}

const SidebarContext = React.createContext<SidebarContextProps | null>(null)

function useSidebar() {
  const context = React.useContext(SidebarContext)
  if (!context) {
    throw new Error("useSidebar must be used within a SidebarProvider.")
  }

  return context
}

function SidebarProvider({
  defaultOpen = true,
  open: openProp,
  onOpenChange: setOpenProp,
  className,
  style,
  children,
  ...props
}: React.ComponentProps<"div"> & {
  defaultOpen?: boolean
  open?: boolean
  onOpenChange?: (open: boolean) => void
}) {
  const isMobile = useIsMobile()
  const [openMobile, setOpenMobile] = React.useState(false)

  // This is the internal state of the sidebar.
  // We use openProp and setOpenProp for control from outside the component.
  const [_open, _setOpen] = React.useState(defaultOpen)
  const open = openProp ?? _open
  const setOpen = React.useCallback(
    (value: boolean | ((value: boolean) => boolean)) => {
      const openState = typeof value === "function" ? value(open) : value
      if (setOpenProp) {
        setOpenProp(openState)
      } else {
        _setOpen(openState)
      }

      // This sets the cookie to keep the sidebar state.
      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`
    },
    [setOpenProp, open]
  )

  // Helper to toggle the sidebar.
  const toggleSidebar = React.useCallback(() => {
    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)
  }, [isMobile, setOpen, setOpenMobile])

  // Adds a keyboard shortcut to toggle the sidebar.
  React.useEffect(() => {
    const handleKeyDown = (event: KeyboardEvent) => {
      if (
        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&
        (event.metaKey || event.ctrlKey)
      ) {
        event.preventDefault()
        toggleSidebar()
      }
    }

    window.addEventListener("keydown", handleKeyDown)
    return () => window.removeEventListener("keydown", handleKeyDown)
  }, [toggleSidebar])

  // We add a state so that we can do data-state="expanded" or "collapsed".
  // This makes it easier to style the sidebar with Tailwind classes.
  const state = open ? "expanded" : "collapsed"

  const contextValue = React.useMemo<SidebarContextProps>(
    () => ({
      state,
      open,
      setOpen,
      isMobile,
      openMobile,
      setOpenMobile,
      toggleSidebar,
    }),
    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]
  )

  return (
    <SidebarContext.Provider value={contextValue}>
      <TooltipProvider delayDuration={0}>
        <div
          data-slot="sidebar-wrapper"
          style={
            {
              "--sidebar-width": SIDEBAR_WIDTH,
              "--sidebar-width-icon": SIDEBAR_WIDTH_ICON,
              ...style,
            } as React.CSSProperties
          }
          className={cn(
            "group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full",
            className
          )}
          {...props}
        >
          {children}
        </div>
      </TooltipProvider>
    </SidebarContext.Provider>
  )
}

function Sidebar({
  side = "left",
  variant = "sidebar",
  collapsible = "offcanvas",
  className,
  children,
  ...props
}: React.ComponentProps<"div"> & {
  side?: "left" | "right"
  variant?: "sidebar" | "floating" | "inset"
  collapsible?: "offcanvas" | "icon" | "none"
}) {
  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()

  if (collapsible === "none") {
    return (
      <div
        data-slot="sidebar"
        className={cn(
          "bg-sidebar text-sidebar-foreground flex h-full w-(--sidebar-width) flex-col",
          className
        )}
        {...props}
      >
        {children}
      </div>
    )
  }

  if (isMobile) {
    return (
      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>
        <SheetContent
          data-sidebar="sidebar"
          data-slot="sidebar"
          data-mobile="true"
          className="bg-sidebar text-sidebar-foreground w-(--sidebar-width) p-0 [&>button]:hidden"
          style={
            {
              "--sidebar-width": SIDEBAR_WIDTH_MOBILE,
            } as React.CSSProperties
          }
          side={side}
        >
          <SheetHeader className="sr-only">
            <SheetTitle>Sidebar</SheetTitle>
            <SheetDescription>Displays the mobile sidebar.</SheetDescription>
          </SheetHeader>
          <div className="flex h-full w-full flex-col">{children}</div>
        </SheetContent>
      </Sheet>
    )
  }

  return (
    <div
      className="group peer text-sidebar-foreground hidden md:block"
      data-state={state}
      data-collapsible={state === "collapsed" ? collapsible : ""}
      data-variant={variant}
      data-side={side}
      data-slot="sidebar"
    >
      {/* This is what handles the sidebar gap on desktop */}
      <div
        data-slot="sidebar-gap"
        className={cn(
          "relative w-(--sidebar-width) bg-transparent transition-[width] duration-200 ease-linear",
          "group-data-[collapsible=offcanvas]:w-0",
          "group-data-[side=right]:rotate-180",
          variant === "floating" || variant === "inset"
            ? "group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4)))]"
            : "group-data-[collapsible=icon]:w-(--sidebar-width-icon)"
        )}
      />
      <div
        data-slot="sidebar-container"
        className={cn(
          "fixed inset-y-0 z-10 hidden h-svh w-(--sidebar-width) transition-[left,right,width] duration-200 ease-linear md:flex",
          side === "left"
            ? "left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]"
            : "right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",
          // Adjust the padding for floating and inset variants.
          variant === "floating" || variant === "inset"
            ? "p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4))+2px)]"
            : "group-data-[collapsible=icon]:w-(--sidebar-width-icon) group-data-[side=left]:border-r group-data-[side=right]:border-l",
          className
        )}
        {...props}
      >
        <div
          data-sidebar="sidebar"
          data-slot="sidebar-inner"
          className="bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm"
        >
          {children}
        </div>
      </div>
    </div>
  )
}

function SidebarTrigger({
  className,
  onClick,
  ...props
}: React.ComponentProps<typeof Button>) {
  const { toggleSidebar } = useSidebar()

  return (
    <Button
      data-sidebar="trigger"
      data-slot="sidebar-trigger"
      variant="ghost"
      size="icon"
      className={cn("size-7", className)}
      onClick={(event) => {
        onClick?.(event)
        toggleSidebar()
      }}
      {...props}
    >
      <PanelLeftIcon />
      <span className="sr-only">Toggle Sidebar</span>
    </Button>
  )
}

function SidebarRail({ className, ...props }: React.ComponentProps<"button">) {
  const { toggleSidebar } = useSidebar()

  return (
    <button
      data-sidebar="rail"
      data-slot="sidebar-rail"
      aria-label="Toggle Sidebar"
      tabIndex={-1}
      onClick={toggleSidebar}
      title="Toggle Sidebar"
      className={cn(
        "hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex",
        "in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize",
        "[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize",
        "hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full",
        "[[data-side=left][data-collapsible=offcanvas]_&]:-right-2",
        "[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",
        className
      )}
      {...props}
    />
  )
}

function SidebarInset({ className, ...props }: React.ComponentProps<"main">) {
  return (
    <main
      data-slot="sidebar-inset"
      className={cn(
        "bg-background relative flex w-full flex-1 flex-col",
        "md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2",
        className
      )}
      {...props}
    />
  )
}

function SidebarInput({
  className,
  ...props
}: React.ComponentProps<typeof Input>) {
  return (
    <Input
      data-slot="sidebar-input"
      data-sidebar="input"
      className={cn("bg-background h-8 w-full shadow-none", className)}
      {...props}
    />
  )
}

function SidebarHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="sidebar-header"
      data-sidebar="header"
      className={cn("flex flex-col gap-2 p-2", className)}
      {...props}
    />
  )
}

function SidebarFooter({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="sidebar-footer"
      data-sidebar="footer"
      className={cn("flex flex-col gap-2 p-2", className)}
      {...props}
    />
  )
}

function SidebarSeparator({
  className,
  ...props
}: React.ComponentProps<typeof Separator>) {
  return (
    <Separator
      data-slot="sidebar-separator"
      data-sidebar="separator"
      className={cn("bg-sidebar-border mx-2 w-auto", className)}
      {...props}
    />
  )
}

function SidebarContent({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="sidebar-content"
      data-sidebar="content"
      className={cn(
        "flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",
        className
      )}
      {...props}
    />
  )
}

function SidebarGroup({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="sidebar-group"
      data-sidebar="group"
      className={cn("relative flex w-full min-w-0 flex-col p-2", className)}
      {...props}
    />
  )
}

function SidebarGroupLabel({
  className,
  asChild = false,
  ...props
}: React.ComponentProps<"div"> & { asChild?: boolean }) {
  const Comp = asChild ? Slot : "div"

  return (
    <Comp
      data-slot="sidebar-group-label"
      data-sidebar="group-label"
      className={cn(
        "text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
        "group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",
        className
      )}
      {...props}
    />
  )
}

function SidebarGroupAction({
  className,
  asChild = false,
  ...props
}: React.ComponentProps<"button"> & { asChild?: boolean }) {
  const Comp = asChild ? Slot : "button"

  return (
    <Comp
      data-slot="sidebar-group-action"
      data-sidebar="group-action"
      className={cn(
        "text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
        // Increases the hit area of the button on mobile.
        "after:absolute after:-inset-2 md:after:hidden",
        "group-data-[collapsible=icon]:hidden",
        className
      )}
      {...props}
    />
  )
}

function SidebarGroupContent({
  className,
  ...props
}: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="sidebar-group-content"
      data-sidebar="group-content"
      className={cn("w-full text-sm", className)}
      {...props}
    />
  )
}

function SidebarMenu({ className, ...props }: React.ComponentProps<"ul">) {
  return (
    <ul
      data-slot="sidebar-menu"
      data-sidebar="menu"
      className={cn("flex w-full min-w-0 flex-col gap-1", className)}
      {...props}
    />
  )
}

function SidebarMenuItem({ className, ...props }: React.ComponentProps<"li">) {
  return (
    <li
      data-slot="sidebar-menu-item"
      data-sidebar="menu-item"
      className={cn("group/menu-item relative", className)}
      {...props}
    />
  )
}

const sidebarMenuButtonVariants = cva(
  "peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",
  {
    variants: {
      variant: {
        default: "hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",
        outline:
          "bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]",
      },
      size: {
        default: "h-8 text-sm",
        sm: "h-7 text-xs",
        lg: "h-12 text-sm group-data-[collapsible=icon]:p-0!",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

function SidebarMenuButton({
  asChild = false,
  isActive = false,
  variant = "default",
  size = "default",
  tooltip,
  className,
  ...props
}: React.ComponentProps<"button"> & {
  asChild?: boolean
  isActive?: boolean
  tooltip?: string | React.ComponentProps<typeof TooltipContent>
} & VariantProps<typeof sidebarMenuButtonVariants>) {
  const Comp = asChild ? Slot : "button"
  const { isMobile, state } = useSidebar()

  const button = (
    <Comp
      data-slot="sidebar-menu-button"
      data-sidebar="menu-button"
      data-size={size}
      data-active={isActive}
      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}
      {...props}
    />
  )

  if (!tooltip) {
    return button
  }

  if (typeof tooltip === "string") {
    tooltip = {
      children: tooltip,
    }
  }

  return (
    <Tooltip>
      <TooltipTrigger asChild>{button}</TooltipTrigger>
      <TooltipContent
        side="right"
        align="center"
        hidden={state !== "collapsed" || isMobile}
        {...tooltip}
      />
    </Tooltip>
  )
}

function SidebarMenuAction({
  className,
  asChild = false,
  showOnHover = false,
  ...props
}: React.ComponentProps<"button"> & {
  asChild?: boolean
  showOnHover?: boolean
}) {
  const Comp = asChild ? Slot : "button"

  return (
    <Comp
      data-slot="sidebar-menu-action"
      data-sidebar="menu-action"
      className={cn(
        "text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
        // Increases the hit area of the button on mobile.
        "after:absolute after:-inset-2 md:after:hidden",
        "peer-data-[size=sm]/menu-button:top-1",
        "peer-data-[size=default]/menu-button:top-1.5",
        "peer-data-[size=lg]/menu-button:top-2.5",
        "group-data-[collapsible=icon]:hidden",
        showOnHover &&
          "peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0",
        className
      )}
      {...props}
    />
  )
}

function SidebarMenuBadge({
  className,
  ...props
}: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="sidebar-menu-badge"
      data-sidebar="menu-badge"
      className={cn(
        "text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none",
        "peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground",
        "peer-data-[size=sm]/menu-button:top-1",
        "peer-data-[size=default]/menu-button:top-1.5",
        "peer-data-[size=lg]/menu-button:top-2.5",
        "group-data-[collapsible=icon]:hidden",
        className
      )}
      {...props}
    />
  )
}

function SidebarMenuSkeleton({
  className,
  showIcon = false,
  ...props
}: React.ComponentProps<"div"> & {
  showIcon?: boolean
}) {
  // Random width between 50 to 90%.
  const width = React.useMemo(() => {
    return `${Math.floor(Math.random() * 40) + 50}%`
  }, [])

  return (
    <div
      data-slot="sidebar-menu-skeleton"
      data-sidebar="menu-skeleton"
      className={cn("flex h-8 items-center gap-2 rounded-md px-2", className)}
      {...props}
    >
      {showIcon && (
        <Skeleton
          className="size-4 rounded-md"
          data-sidebar="menu-skeleton-icon"
        />
      )}
      <Skeleton
        className="h-4 max-w-(--skeleton-width) flex-1"
        data-sidebar="menu-skeleton-text"
        style={
          {
            "--skeleton-width": width,
          } as React.CSSProperties
        }
      />
    </div>
  )
}

function SidebarMenuSub({ className, ...props }: React.ComponentProps<"ul">) {
  return (
    <ul
      data-slot="sidebar-menu-sub"
      data-sidebar="menu-sub"
      className={cn(
        "border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5",
        "group-data-[collapsible=icon]:hidden",
        className
      )}
      {...props}
    />
  )
}

function SidebarMenuSubItem({
  className,
  ...props
}: React.ComponentProps<"li">) {
  return (
    <li
      data-slot="sidebar-menu-sub-item"
      data-sidebar="menu-sub-item"
      className={cn("group/menu-sub-item relative", className)}
      {...props}
    />
  )
}

function SidebarMenuSubButton({
  asChild = false,
  size = "md",
  isActive = false,
  className,
  ...props
}: React.ComponentProps<"a"> & {
  asChild?: boolean
  size?: "sm" | "md"
  isActive?: boolean
}) {
  const Comp = asChild ? Slot : "a"

  return (
    <Comp
      data-slot="sidebar-menu-sub-button"
      data-sidebar="menu-sub-button"
      data-size={size}
      data-active={isActive}
      className={cn(
        "text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",
        "data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",
        size === "sm" && "text-xs",
        size === "md" && "text-sm",
        "group-data-[collapsible=icon]:hidden",
        className
      )}
      {...props}
    />
  )
}

export {
  Sidebar,
  SidebarContent,
  SidebarFooter,
  SidebarGroup,
  SidebarGroupAction,
  SidebarGroupContent,
  SidebarGroupLabel,
  SidebarHeader,
  SidebarInput,
  SidebarInset,
  SidebarMenu,
  SidebarMenuAction,
  SidebarMenuBadge,
  SidebarMenuButton,
  SidebarMenuItem,
  SidebarMenuSkeleton,
  SidebarMenuSub,
  SidebarMenuSubButton,
  SidebarMenuSubItem,
  SidebarProvider,
  SidebarRail,
  SidebarSeparator,
  SidebarTrigger,
  useSidebar,
}
</file>

<file path="src/components/ui/skeleton.tsx">
import { cn } from "@/lib/utils"

function Skeleton({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="skeleton"
      className={cn("bg-accent animate-pulse rounded-md", className)}
      {...props}
    />
  )
}

export { Skeleton }
</file>

<file path="src/components/ui/sonner.tsx">
import {
  CircleCheckIcon,
  InfoIcon,
  Loader2Icon,
  OctagonXIcon,
  TriangleAlertIcon,
} from "lucide-react"
import { useTheme } from "next-themes"
import { Toaster as Sonner, type ToasterProps } from "sonner"

const Toaster = ({ ...props }: ToasterProps) => {
  const { theme = "system" } = useTheme()

  return (
    <Sonner
      theme={theme as ToasterProps["theme"]}
      className="toaster group"
      icons={{
        success: <CircleCheckIcon className="size-4" />,
        info: <InfoIcon className="size-4" />,
        warning: <TriangleAlertIcon className="size-4" />,
        error: <OctagonXIcon className="size-4" />,
        loading: <Loader2Icon className="size-4 animate-spin" />,
      }}
      style={
        {
          "--normal-bg": "var(--popover)",
          "--normal-text": "var(--popover-foreground)",
          "--normal-border": "var(--border)",
          "--border-radius": "var(--radius)",
        } as React.CSSProperties
      }
      {...props}
    />
  )
}

export { Toaster }
</file>

<file path="src/components/ui/table.tsx">
import * as React from "react"

import { cn } from "@/lib/utils"

function Table({ className, ...props }: React.ComponentProps<"table">) {
  return (
    <div
      data-slot="table-container"
      className="relative w-full overflow-x-auto"
    >
      <table
        data-slot="table"
        className={cn("w-full caption-bottom text-sm", className)}
        {...props}
      />
    </div>
  )
}

function TableHeader({ className, ...props }: React.ComponentProps<"thead">) {
  return (
    <thead
      data-slot="table-header"
      className={cn("[&_tr]:border-b", className)}
      {...props}
    />
  )
}

function TableBody({ className, ...props }: React.ComponentProps<"tbody">) {
  return (
    <tbody
      data-slot="table-body"
      className={cn("[&_tr:last-child]:border-0", className)}
      {...props}
    />
  )
}

function TableFooter({ className, ...props }: React.ComponentProps<"tfoot">) {
  return (
    <tfoot
      data-slot="table-footer"
      className={cn(
        "bg-muted/50 border-t font-medium [&>tr]:last:border-b-0",
        className
      )}
      {...props}
    />
  )
}

function TableRow({ className, ...props }: React.ComponentProps<"tr">) {
  return (
    <tr
      data-slot="table-row"
      className={cn(
        "hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",
        className
      )}
      {...props}
    />
  )
}

function TableHead({ className, ...props }: React.ComponentProps<"th">) {
  return (
    <th
      data-slot="table-head"
      className={cn(
        "text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",
        className
      )}
      {...props}
    />
  )
}

function TableCell({ className, ...props }: React.ComponentProps<"td">) {
  return (
    <td
      data-slot="table-cell"
      className={cn(
        "p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",
        className
      )}
      {...props}
    />
  )
}

function TableCaption({
  className,
  ...props
}: React.ComponentProps<"caption">) {
  return (
    <caption
      data-slot="table-caption"
      className={cn("text-muted-foreground mt-4 text-sm", className)}
      {...props}
    />
  )
}

export {
  Table,
  TableHeader,
  TableBody,
  TableFooter,
  TableHead,
  TableRow,
  TableCell,
  TableCaption,
}
</file>

<file path="src/components/ui/tooltip.tsx">
import * as React from "react"
import * as TooltipPrimitive from "@radix-ui/react-tooltip"

import { cn } from "@/lib/utils"

function TooltipProvider({
  delayDuration = 0,
  ...props
}: React.ComponentProps<typeof TooltipPrimitive.Provider>) {
  return (
    <TooltipPrimitive.Provider
      data-slot="tooltip-provider"
      delayDuration={delayDuration}
      {...props}
    />
  )
}

function Tooltip({
  ...props
}: React.ComponentProps<typeof TooltipPrimitive.Root>) {
  return (
    <TooltipProvider>
      <TooltipPrimitive.Root data-slot="tooltip" {...props} />
    </TooltipProvider>
  )
}

function TooltipTrigger({
  ...props
}: React.ComponentProps<typeof TooltipPrimitive.Trigger>) {
  return <TooltipPrimitive.Trigger data-slot="tooltip-trigger" {...props} />
}

function TooltipContent({
  className,
  sideOffset = 0,
  children,
  ...props
}: React.ComponentProps<typeof TooltipPrimitive.Content>) {
  return (
    <TooltipPrimitive.Portal>
      <TooltipPrimitive.Content
        data-slot="tooltip-content"
        sideOffset={sideOffset}
        className={cn(
          "bg-foreground text-background animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",
          className
        )}
        {...props}
      >
        {children}
        <TooltipPrimitive.Arrow className="bg-foreground fill-foreground z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]" />
      </TooltipPrimitive.Content>
    </TooltipPrimitive.Portal>
  )
}

export { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }
</file>

<file path="src/config/sidebar.config.ts">
import {
    SquareTerminal,
    type LucideIcon, Building2, UserPen, Grid2x2Plus, FilePlusCorner, Building,
} from "lucide-react"
import type { UserRole } from "@/types/enums.ts";

export interface NavItem {
    title: string
    url: string
    icon?: LucideIcon
    allowedRoles?: UserRole[]
    items?: {
        title: string
        url: string
    }[]
}

export const sidebarConfig = {
    brand: {
        name: "EcoFinance",
        plan: "Enterprise",
        logo: SquareTerminal,
    },
    navMain: [
        {
            title: "Dashboard",
            url: "/home",
            icon: SquareTerminal,
            items: [
                { title: "Overview", url: "/home" },
                { title: "Analytics", url: "/analytics" }, // Add your routes here
            ],
        },
        // Master only
        {
            title: "Empresas",
            url: "/managers/companies", // Matches 'units' case in useManagerConfig
            icon: Building,
            allowedRoles: ['MASTER'],
        },

        // Master and Admin
        {
            title: "Unidades Empresariais",
            url: "/managers/units", // Matches 'units' case in useManagerConfig
            icon: Building2,
            allowedRoles: ['MASTER', 'ADMIN'],
        },
        {
            title: "Cadastro de Responsveis",
            url: "/managers/users", // Matches 'users' case
            icon: UserPen,
            allowedRoles: ['MASTER', 'ADMIN'],
        },
        {
            title: "Cadastro de Fontes",
            url: "/managers/sources", // Matches 'sources' case
            icon: Grid2x2Plus,
            allowedRoles: ['MASTER', 'ADMIN'],
        },

        // Everyone
        {
            title: "Reporte de Dados",
            url: "/reports",
            icon: FilePlusCorner,
            items: [
                { title: "Combusto Mvel", url: "/reports/mobile-combustion" },
                { title: "rea de Conservao", url: "/reports/conservation-area" }, // Add your routes here
            ],
        },
    ] as NavItem[],
}
</file>

<file path="src/features/auth/components/LoginCard.tsx">
import type { FormEvent } from "react";
import { Card } from "@/components/ui/card";
import LoginCardHeader from "@/features/auth/components/LoginCardHeader.tsx";
import LoginCardFooter from "@/features/auth/components/LoginCardFooter.tsx";
import LoginCardContent from "@/features/auth/components/LoginCardContent.tsx";
import { useLogin } from "@/features/auth/hooks/useLogin.ts";

function LoginCard() {
    // 1. Initialize the hook
    const { mutate, isPending } = useLogin();
    const FORM_ID = "login-form";

    // 2. Create the submit handler
    const handleSubmit = (e: FormEvent<HTMLFormElement>) => {
        e.preventDefault();

        // Extract data natively using FormData (no state needed!)
        const formData = new FormData(e.currentTarget);
        const email = formData.get("email") as string;
        const password = formData.get("password") as string;

        // 3. Call the mutation
        mutate({ email, password });
    };

    return (
        <Card className="w-full max-w-sm">
            <LoginCardHeader/>

            <LoginCardContent
                formId={FORM_ID}
                onSubmit={handleSubmit}
            />

            <LoginCardFooter
                formId={FORM_ID}
                isLoading={isPending}
            />
        </Card>
    );
}

export default LoginCard;
</file>

<file path="src/features/auth/components/LoginCardContent.tsx">
import { CardContent } from "@/components/ui/card.tsx";
import LoginEmailInput from "@/features/auth/components/LoginEmailInput.tsx";
import LoginPasswordInput from "./LoginPasswordInput";
import type { FormEvent } from "react";

interface LoginCardContentProps {
    onSubmit: (e: FormEvent<HTMLFormElement>) => void;
    formId: string;
}

function LoginCardContent({ onSubmit, formId }: LoginCardContentProps) {
    return (
        <CardContent>
            <form id={formId} onSubmit={onSubmit}>
                <div className="flex flex-col gap-6">
                    <LoginEmailInput/>
                    <LoginPasswordInput/>
                </div>
            </form>
        </CardContent>
    );
}

export default LoginCardContent;
</file>

<file path="src/features/auth/components/LoginCardFooter.tsx">
import { CardFooter } from "@/components/ui/card.tsx";
import { Button } from "@/components/ui/button.tsx";

interface LoginCardFooterProps {
    isLoading: boolean;
    formId: string;
}

function LoginCardFooter({ isLoading, formId }: LoginCardFooterProps) {
    return <CardFooter className="flex-col gap-2">
        <Button
            type="submit"
            className="w-full"
            form={formId}
            disabled={isLoading}
        >
            {isLoading ? "Entrando..." : "Login"}
        </Button>
    </CardFooter>;
}

export default LoginCardFooter;
</file>

<file path="src/features/auth/components/LoginCardHeader.tsx">
import { CardDescription, CardHeader, CardTitle } from "@/components/ui/card.tsx";

function LoginCardHeader() {
    return <CardHeader className="flex flex-col items-start">
        <CardTitle>Entre em sua conta</CardTitle>
        <CardDescription>
            Insira seu e-mail para entrar
        </CardDescription>
    </CardHeader>;
}

export default LoginCardHeader;
</file>

<file path="src/features/auth/components/LoginEmailInput.tsx">
import { Label } from "@/components/ui/label.tsx";
import { Input } from "@/components/ui/input.tsx";

function LoginEmailInput() {
    return <div className="grid gap-2">
        <Label htmlFor="email">E-mail</Label>
        <Input
            id="email"
            type="email"
            name="email"
            placeholder="joao@ecofinance.com.br"
            required
        />
    </div>;
}

export default LoginEmailInput
</file>

<file path="src/features/auth/components/LoginPasswordInput.tsx">
import { Label } from "@/components/ui/label.tsx";
import { Input } from "@/components/ui/input.tsx";

function LoginPasswordInput() {
    return <div className="grid gap-2">
        <div className="flex items-center">
            <Label htmlFor="password">Senha</Label>
            <a
                href="#"
                className="ml-auto inline-block text-sm underline-offset-4 hover:underline"
            >
                Esqueceu sua senha?
            </a>
        </div>
        <Input id="password" type="password" name="password" required/>
    </div>;
}

export default LoginPasswordInput;
</file>

<file path="src/features/auth/hooks/useLogin.ts">
import { useAuthStore } from "@/store/authStore.ts";
import { useMutation } from "@tanstack/react-query";
import api from "@/api/api.ts";
import type { User } from "@/types/User.ts";

export const useLogin = () => {
    const login = useAuthStore((state) => state.login);

    return useMutation({
        mutationFn: async (credentials: { email: string; password: string }) => {
            const { data } = await api.post('/auth/login', credentials);
            return data;
        },
        onSuccess: (data: { token: string, user: User}) => {
            login(data.token, data.user);
        }
    })
}
</file>

<file path="src/features/managers/components/ManagerAccordion.tsx">
import { Collapsible, CollapsibleContent, } from "@/components/ui/collapsible"
import { ManagerForm } from "./ManagerForm"
import type { FieldConfig } from "../hooks/useManagerConfig"

interface ManagerAccordionProps {
    isOpen: boolean
    setIsOpen: (open: boolean) => void
    fields: FieldConfig[]
    initialData?: any
    onSubmit: (data: any) => Promise<void>
    isLoading: boolean
}

export function ManagerAccordion({
                                     isOpen,
                                     setIsOpen,
                                     fields,
                                     initialData,
                                     onSubmit,
                                     isLoading,
                                 }: ManagerAccordionProps) {
    return (
        <Collapsible
            open={isOpen}
            onOpenChange={setIsOpen}
        >
            <CollapsibleContent className=" pb-4">
                <div className="bg-white p-4 rounded-md border shadow-sm">
                    <ManagerForm
                        fields={fields}
                        initialData={initialData}
                        onSubmit={onSubmit}
                        isLoading={isLoading}
                        onCancel={() => setIsOpen(false)}
                    />
                </div>
            </CollapsibleContent>
        </Collapsible>
    )
}
</file>

<file path="src/features/managers/components/ManagerColumns.tsx">
import type { ColumnDef } from "@tanstack/react-table";
import type { ColumnConfig } from "../hooks/useManagerConfig";
import { Badge } from "@/components/ui/badge";
import { Check, X, MoreHorizontal, Pencil, Trash } from "lucide-react";
import { Button } from "@/components/ui/button";
import {
    DropdownMenu,
    DropdownMenuContent,
    DropdownMenuItem,
    DropdownMenuLabel,
    DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu";

const formatDate = (dateString: string) => {
    if (!dateString) return "-";
    return new Date(dateString).toLocaleDateString("pt-BR");
};

export const generateColumns = (
    configColumns: ColumnConfig[],
    onEdit: (item: any) => void,
    onDelete: (item: any) => void
): ColumnDef<any>[] => {

    const generated: ColumnDef<any>[] = configColumns.map((col) => ({
        accessorKey: col.key, // This works for "company.name"
        header: col.label,
        // FIX: Use 'info' to get the value, not 'row.getValue'
        cell: (info) => {
            const value = info.getValue() as string | boolean | number | null;

            switch (col.type) {
                case 'boolean':
                    return value ? (
                        <div className="flex justify-start"><Check className="size-4 text-green-600" /></div>
                    ) : (
                        <div className="flex justify-start"><X className="size-4 text-red-400" /></div>
                    );

                case 'badge':
                    return (
                        <Badge variant={value === 'USER' ? 'secondary' : 'default'}>
                            {String(value)}
                        </Badge>
                    );

                case 'date':
                    return <span className="text-muted-foreground">{formatDate(String(value))}</span>;

                case 'email':
                    return <a href={`mailto:${value}`} className="text-blue-600 hover:underline">{String(value)}</a>;

                default:
                    return <span className="font-medium">{String(value ?? '-')}</span>;
            }
        }
    }));

    // Actions Column
    generated.push({
        id: "actions",
        cell: ({ row }) => {
            const item = row.original;
            return (
                <DropdownMenu>
                    <DropdownMenuTrigger asChild>
                        <Button variant="ghost" className="h-8 w-8 p-0">
                            <span className="sr-only">Open menu</span>
                            <MoreHorizontal className="size-4" />
                        </Button>
                    </DropdownMenuTrigger>
                    <DropdownMenuContent align="end">
                        <DropdownMenuLabel>Aes</DropdownMenuLabel>
                        <DropdownMenuItem onClick={() => onEdit(item)}>
                            <Pencil className="mr-2 size-4" /> Editar
                        </DropdownMenuItem>
                        <DropdownMenuItem onClick={() => onDelete(item)} className="text-red-600 focus:text-red-600">
                            <Trash className="mr-2 size-4" /> Excluir
                        </DropdownMenuItem>
                    </DropdownMenuContent>
                </DropdownMenu>
            );
        },
    });

    return generated;
};
</file>

<file path="src/features/managers/components/ManagerForm.tsx">
import { useEffect } from "react";
import { useForm } from "react-hook-form";
import type { FieldConfig } from "../hooks/useManagerConfig";
import { useManagerData } from "../hooks/useManagerData"; // Import the data hook
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import {
    Select,
    SelectContent,
    SelectItem,
    SelectTrigger,
    SelectValue,
} from "@/components/ui/select";
import { Loader2 } from "lucide-react";

interface ManagerFormProps {
    fields: FieldConfig[];
    initialData?: any;
    onSubmit: (data: any) => Promise<void>;
    isLoading: boolean;
    onCancel: () => void;
}

export function ManagerForm({
                                fields,
                                initialData,
                                onSubmit,
                                isLoading,
                                onCancel,
                            }: ManagerFormProps) {
    // 1. Initialize Form
    const {
        register,
        handleSubmit,
        setValue,
        watch,
        reset,
        formState: { errors },
    } = useForm({
        defaultValues: initialData || {},
    });

    // 2. Load Dynamic Data (Companies & Units)
    // We fetch these regardless of the current page to ensure dropdowns always have data.
    // React Query will cache this, so it's efficient.
    const { data: companiesData } = useManagerData('companies');
    const { data: unitsData } = useManagerData('units');

    // 3. Reset form when opening/closing or changing selection
    useEffect(() => {
        if (initialData) {
            reset(initialData);
        } else {
            reset({}); // Clear form for "New" mode
        }
    }, [initialData, reset]);

    // 4. Helper to resolve options
    const getOptions = (field: FieldConfig) => {
        // Priority 1: Static Options (defined in config)
        if (field.options) return field.options;

        // Priority 2: Dynamic Companies
        if (field.dynamicOptions === 'companies') {
            return companiesData?.map((c: any) => ({
                label: c.name,
                value: c.id
            })) || [];
        }

        // Priority 3: Dynamic Units
        if (field.dynamicOptions === 'units') {
            return unitsData?.map((u: any) => ({
                label: u.name,
                value: u.id
            })) || [];
        }

        return [];
    };

    // 5. Render Helper
    const renderField = (field: FieldConfig) => {
        const options = getOptions(field);

        const currentValue = watch(field.name);

        switch (field.type) {
            case "select":
                return (
                    <Select
                        value={currentValue ? String(currentValue) : undefined}
                        onValueChange={(val) => setValue(field.name, val)}
                        defaultValue={
                            initialData?.[field.name]
                                ? String(initialData[field.name])
                                : undefined
                        }
                    >
                        <SelectTrigger className="w-full">
                            <SelectValue placeholder="Selecione..." />
                        </SelectTrigger>
                        <SelectContent>
                            {options.length > 0 ? (
                                options.map((opt: any) => (
                                    <SelectItem key={opt.value} value={String(opt.value)}>
                                        {opt.label}
                                    </SelectItem>
                                ))
                            ) : (
                                <div className="p-2 text-sm text-gray-500 text-center">
                                    Nenhum item disponvel
                                </div>
                            )}
                        </SelectContent>
                    </Select>
                );

            case "boolean":
                return (
                    <Select
                        value={currentValue !== undefined ? String(currentValue) : undefined}
                        onValueChange={(val) => setValue(field.name, val === "true")}
                        defaultValue={
                            initialData?.[field.name] !== undefined
                                ? String(initialData[field.name])
                                : undefined
                        }
                    >
                        <SelectTrigger>
                            <SelectValue placeholder="Selecione..." />
                        </SelectTrigger>
                        <SelectContent>
                            <SelectItem value="true">Sim (Ativo)</SelectItem>
                            <SelectItem value="false">No (Inativo)</SelectItem>
                        </SelectContent>
                    </Select>
                );

            case "number":
                return (
                    <Input
                        type="number"
                        placeholder={field.label}
                        {...register(field.name, {
                            required: field.required,
                            valueAsNumber: true // Important for Zod validation
                        })}
                    />
                );

            default: // text, email, password
                return (
                    <Input
                        type={field.type}
                        placeholder={field.label}
                        {...register(field.name, { required: field.required })}
                    />
                );
        }
    };

    return (
        <form onSubmit={handleSubmit(onSubmit)} className="space-y-4 py-4">
            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                {fields.map((field) => (
                    <div key={field.name} className="space-y-2">
                        <Label htmlFor={field.name} className="text-sm font-medium">
                            {field.label}{" "}
                            {field.required && <span className="text-red-500">*</span>}
                        </Label>

                        {renderField(field)}

                        {errors[field.name] && (
                            <span className="text-xs text-red-500">Campo obrigatrio</span>
                        )}
                    </div>
                ))}
            </div>

            <div className="flex justify-end space-x-2 pt-4 border-t mt-4">
                <Button variant="outline" type="button" onClick={onCancel}>
                    Cancelar
                </Button>
                <Button type="submit" disabled={isLoading}>
                    {isLoading && <Loader2 className="mr-2 h-4 w-4 animate-spin" />}
                    {isLoading ? "Salvando..." : "Salvar Registro"}
                </Button>
            </div>
        </form>
    );
}
</file>

<file path="src/features/managers/hooks/useManagerConfig.ts">
import { useMemo } from 'react';
import type { User } from '@/types/User';

const BR_STATES = [
    { label: 'Acre', value: 'AC' }, { label: 'Alagoas', value: 'AL' }, { label: 'Amap', value: 'AP' },
    { label: 'Amazonas', value: 'AM' }, { label: 'Bahia', value: 'BA' }, { label: 'Cear', value: 'CE' },
    { label: 'Distrito Federal', value: 'DF' }, { label: 'Esprito Santo', value: 'ES' }, { label: 'Gois', value: 'GO' },
    { label: 'Maranho', value: 'MA' }, { label: 'Mato Grosso', value: 'MT' }, { label: 'Mato Grosso do Sul', value: 'MS' },
    { label: 'Minas Gerais', value: 'MG' }, { label: 'Par', value: 'PA' }, { label: 'Paraba', value: 'PB' },
    { label: 'Paran', value: 'PR' }, { label: 'Pernambuco', value: 'PE' }, { label: 'Piau', value: 'PI' },
    { label: 'Rio de Janeiro', value: 'RJ' }, { label: 'Rio Grande do Norte', value: 'RN' }, { label: 'Rio Grande do Sul', value: 'RS' },
    { label: 'Rondnia', value: 'RO' }, { label: 'Roraima', value: 'RR' }, { label: 'Santa Catarina', value: 'SC' },
    { label: 'So Paulo', value: 'SP' }, { label: 'Sergipe', value: 'SE' }, { label: 'Tocantins', value: 'TO' }
];

export type ManagerType = 'users' | 'units' | 'companies' | 'sources';

export interface ColumnConfig {
    key: string;
    label: string;
    type: 'text' | 'email' | 'badge' | 'date' | 'boolean';
}

export interface FieldConfig {
    name: string;
    label: string;
    type: 'text' | 'email' | 'select' | 'password' | 'number' | 'boolean';
    options?: { label: string; value: string | number }[]; // Static options
    dynamicOptions?: 'companies' | 'units'; // NEW: Dynamic Source
    required?: boolean;
}

export interface ManagerViewConfig {
    title: string;
    description: string;
    isAllowed: boolean; // Simple flag: All or Nothing
    columns: ColumnConfig[];
    fields: FieldConfig[];
}

export const useManagerConfig = (type: ManagerType, user: User | null): ManagerViewConfig => {
    return useMemo(() => {
        // 1. Role Helpers
        const role = user?.role;
        const isMaster = role === 'MASTER';
        const isAdmin = role === 'ADMIN';

        // 2. Define Configuration
        switch (type) {
            case 'companies':
                // RULE: Only MASTER can touch Companies
                if (!isMaster) {
                    return { title: 'Restrito', description: '', isAllowed: false, columns: [], fields: [] };
                }
                return {
                    title: 'Empresas',
                    description: 'Gerencie as empresas (Tenants) do sistema.',
                    isAllowed: true,
                    columns: [
                        { key: 'name', label: 'Nome Empresarial', type: 'text' },
                        { key: 'cnpj', label: 'CNPJ', type: 'text' },
                        { key: 'createdAt', label: 'Data Criao', type: 'date' },
                    ],
                    fields: [
                        { name: 'name', label: 'Nome da Empresa', type: 'text', required: true },
                        { name: 'cnpj', label: 'CNPJ', type: 'text', required: true },
                    ]
                };

            case 'units':
                // RULE: MASTER or ADMIN
                if (!isMaster && !isAdmin) {
                    return { title: 'Restrito', description: '', isAllowed: false, columns: [], fields: [] };
                }
                return {
                    title: 'Unidades',
                    description: 'Gerencie as unidades operacionais.',
                    isAllowed: true,
                    // Task 2: Show Company in Table
                    columns: [
                        { key: 'name', label: 'Nome da Unidade', type: 'text' },
                        { key: 'company.name', label: 'Empresa', type: 'text' }, // <--- Deep Accessor
                        { key: 'city', label: 'Cidade', type: 'text' },
                        { key: 'state', label: 'Estado', type: 'text' },
                        { key: 'numberOfWorkers', label: 'Colaboradores', type: 'text' },
                    ],
                    // Task 1: Fields as per image (inferred)
                    fields: [
                        { name: 'name', label: 'Nome da Unidade', type: 'text', required: true },
                        // Dynamic Select for Company
                        { name: 'companyId', label: 'Empresa', type: 'select', dynamicOptions: 'companies', required: true },
                        { name: 'city', label: 'Cidade', type: 'text', required: true },
                        { name: 'state', label: 'Estado (UF)', type: 'select', options: BR_STATES, required: true },
                        { name: 'country', label: 'Pas', type: 'text', required: true }, // Added Country
                        { name: 'numberOfWorkers', label: 'N Colaboradores', type: 'number', required: true },
                    ]
                };

            case 'users':
                // RULE: MASTER or ADMIN
                if (!isMaster && !isAdmin) {
                    return { title: 'Restrito', description: '', isAllowed: false, columns: [], fields: [] };
                }
                return {
                    title: 'Usurios',
                    description: 'Gerencie acesso e permisses.',
                    isAllowed: true,
                    columns: [
                        { key: 'name', label: 'Nome', type: 'text' },
                        { key: 'email', label: 'E-mail', type: 'email' },
                        { key: 'role', label: 'Perfil', type: 'badge' },
                    ],
                    fields: [
                        { name: 'name', label: 'Nome', type: 'text', required: true },
                        { name: 'email', label: 'E-mail', type: 'email', required: true },
                        { name: 'password', label: 'Senha', type: 'password', required: true },
                        {
                            name: 'role', label: 'Perfil', type: 'select', options: [
                                { label: 'Admin', value: 'ADMIN' },
                                { label: 'User', value: 'USER' }
                            ], required: true
                        }
                    ]
                };

            case 'sources':
                // RULE: MASTER or ADMIN
                if (!isMaster && !isAdmin) {
                    return { title: 'Restrito', description: '', isAllowed: false, columns: [], fields: [] };
                }
                return {
                    title: 'Fontes de Emisso',
                    description: 'Cadastre mquinas e veculos.',
                    isAllowed: true,
                    columns: [
                        { key: 'description', label: 'Descrio', type: 'text' },
                        { key: 'sourceType', label: 'Tipo', type: 'text' },
                        { key: 'isActive', label: 'Ativo', type: 'boolean' },
                    ],
                    fields: [
                        { name: 'description', label: 'Nome', type: 'text', required: true },
                        {
                            name: 'sourceType', label: 'Tipo', type: 'select', options: [
                                { label: 'Combusto Mvel', value: 'mobile_combustion' },
                                { label: 'Combusto Estacionria', value: 'stationary_combustion' }
                            ], required: true
                        }
                    ]
                };

            default:
                return { title: 'Erro', description: 'Mdulo desconhecido', isAllowed: false, columns: [], fields: [] };
        }
    }, [type, user]);
};
</file>

<file path="src/features/managers/hooks/useManagerData.ts">
import { useQuery, useMutation, useQueryClient } from "@tanstack/react-query";
import api from "@/api/api";
import type { ManagerType } from "./useManagerConfig";
import { toast } from "sonner";

// 1. Map "Manager Types" to "API Endpoints"
const ENDPOINT_MAP: Record<ManagerType, string> = {
    companies: "/admin/companies",
    units: "/admin/units",
    users: "/users",
    sources: "/esg/config/typologies" // Matches the endpoint we created earlier
};

export const useManagerData = (type: ManagerType) => {
    const queryClient = useQueryClient();
    const endpoint = ENDPOINT_MAP[type];

    // --- FETCH (READ) ---
    const { data, isLoading, isError, error } = useQuery({
        queryKey: [type], // e.g., ['users'], ['units']
        queryFn: async () => {
            const response = await api.get(endpoint);
            return response.data;
        },
    });

    // --- DELETE ---
    const deleteMutation = useMutation({
        mutationFn: async (id: number | string) => {
            await api.delete(`${endpoint}/${id}`);
        },
        onSuccess: () => {
            // 1. Refetch the list automatically
            queryClient.invalidateQueries({ queryKey: [type] });
            toast.success("Registro excludo com sucesso.");
        },
        onError: (err: any) => {
            toast.error(err.response?.data?.message || "Erro ao excluir registro.");
        },
    });

    return {
        data: data || [], // Always return array to avoid crashes
        isLoading,
        isError,
        error,
        deleteItem: deleteMutation.mutateAsync,
        isDeleting: deleteMutation.isPending
    };
};
</file>

<file path="src/features/managers/hooks/useManagerMutation.ts">
import { useMutation, useQueryClient } from "@tanstack/react-query";
import api from "@/api/api";
import type { ManagerType } from "./useManagerConfig";
import { toast } from "sonner";

const ENDPOINT_MAP: Record<ManagerType, string> = {
    companies: "/admin/companies",
    units: "/admin/units",
    users: "/users",
    sources: "/esg/config/typologies"
};

export const useManagerMutations = (type: ManagerType, onCloseModal?: () => void) => {
    const queryClient = useQueryClient();
    const endpoint = ENDPOINT_MAP[type];

    // --- CREATE ---
    const createMutation = useMutation({
        mutationFn: async (payload: any) => {
            const response = await api.post(endpoint, payload);
            return response.data;
        },
        onSuccess: () => {
            queryClient.invalidateQueries({ queryKey: [type] });
            toast.success("Registro criado com sucesso!");
            if (onCloseModal) onCloseModal();
        },
        onError: (err: any) => {
            toast.error(err.response?.data?.message || "Erro ao criar registro.");
        }
    });

    // --- UPDATE ---
    const updateMutation = useMutation({
        mutationFn: async ({ id, data }: { id: string | number; data: any }) => {
            const response = await api.put(`${endpoint}/${id}`, data);
            return response.data;
        },
        onSuccess: () => {
            queryClient.invalidateQueries({ queryKey: [type] });
            toast.success("Registro atualizado com sucesso!");
            if (onCloseModal) onCloseModal();
        },
        onError: (err: any) => {
            toast.error(err.response?.data?.message || "Erro ao atualizar registro.");
        }
    });

    return {
        createItem: createMutation.mutateAsync,
        updateItem: updateMutation.mutateAsync,
        isSaving: createMutation.isPending || updateMutation.isPending
    };
};
</file>

<file path="src/hooks/use-mobile.ts">
import * as React from "react"

const MOBILE_BREAKPOINT = 768

export function useIsMobile() {
  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)

  React.useEffect(() => {
    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)
    const onChange = () => {
      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)
    }
    mql.addEventListener("change", onChange)
    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)
    return () => mql.removeEventListener("change", onChange)
  }, [])

  return !!isMobile
}
</file>

<file path="src/index.css">
@import "tailwindcss";
@import "tw-animate-css";

@custom-variant dark (&:is(.dark *));

@theme inline {
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);
  --radius-2xl: calc(var(--radius) + 8px);
  --radius-3xl: calc(var(--radius) + 12px);
  --radius-4xl: calc(var(--radius) + 16px);
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);
  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);
  --color-destructive: var(--destructive);
  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);
  --color-chart-1: var(--chart-1);
  --color-chart-2: var(--chart-2);
  --color-chart-3: var(--chart-3);
  --color-chart-4: var(--chart-4);
  --color-chart-5: var(--chart-5);
  --color-sidebar: var(--sidebar);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);
}

:root {
  --radius: 0.625rem;
  --background: oklch(1 0 0);
  --foreground: oklch(0.145 0 0);
  --card: oklch(1 0 0);
  --card-foreground: oklch(0.145 0 0);
  --popover: oklch(1 0 0);
  --popover-foreground: oklch(0.145 0 0);
  --primary: oklch(0.205 0 0);
  --primary-foreground: oklch(0.985 0 0);
  --secondary: oklch(0.97 0 0);
  --secondary-foreground: oklch(0.205 0 0);
  --muted: oklch(0.97 0 0);
  --muted-foreground: oklch(0.556 0 0);
  --accent: oklch(0.97 0 0);
  --accent-foreground: oklch(0.205 0 0);
  --destructive: oklch(0.577 0.245 27.325);
  --border: oklch(0.922 0 0);
  --input: oklch(0.922 0 0);
  --ring: oklch(0.708 0 0);
  --chart-1: oklch(0.646 0.222 41.116);
  --chart-2: oklch(0.6 0.118 184.704);
  --chart-3: oklch(0.398 0.07 227.392);
  --chart-4: oklch(0.828 0.189 84.429);
  --chart-5: oklch(0.769 0.188 70.08);
  --sidebar: oklch(0.985 0 0);
  --sidebar-foreground: oklch(0.145 0 0);
  --sidebar-primary: oklch(0.205 0 0);
  --sidebar-primary-foreground: oklch(0.985 0 0);
  --sidebar-accent: oklch(0.97 0 0);
  --sidebar-accent-foreground: oklch(0.205 0 0);
  --sidebar-border: oklch(0.922 0 0);
  --sidebar-ring: oklch(0.708 0 0);
}

.dark {
  --background: oklch(0.145 0 0);
  --foreground: oklch(0.985 0 0);
  --card: oklch(0.205 0 0);
  --card-foreground: oklch(0.985 0 0);
  --popover: oklch(0.205 0 0);
  --popover-foreground: oklch(0.985 0 0);
  --primary: oklch(0.922 0 0);
  --primary-foreground: oklch(0.205 0 0);
  --secondary: oklch(0.269 0 0);
  --secondary-foreground: oklch(0.985 0 0);
  --muted: oklch(0.269 0 0);
  --muted-foreground: oklch(0.708 0 0);
  --accent: oklch(0.269 0 0);
  --accent-foreground: oklch(0.985 0 0);
  --destructive: oklch(0.704 0.191 22.216);
  --border: oklch(1 0 0 / 10%);
  --input: oklch(1 0 0 / 15%);
  --ring: oklch(0.556 0 0);
  --chart-1: oklch(0.488 0.243 264.376);
  --chart-2: oklch(0.696 0.17 162.48);
  --chart-3: oklch(0.769 0.188 70.08);
  --chart-4: oklch(0.627 0.265 303.9);
  --chart-5: oklch(0.645 0.246 16.439);
  --sidebar: oklch(0.205 0 0);
  --sidebar-foreground: oklch(0.985 0 0);
  --sidebar-primary: oklch(0.488 0.243 264.376);
  --sidebar-primary-foreground: oklch(0.985 0 0);
  --sidebar-accent: oklch(0.269 0 0);
  --sidebar-accent-foreground: oklch(0.985 0 0);
  --sidebar-border: oklch(1 0 0 / 10%);
  --sidebar-ring: oklch(0.556 0 0);
}

@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  body {
    @apply bg-background text-foreground;
  }
}
</file>

<file path="src/lib/authUtils.ts">
export function isTokenExpired(token: string): boolean {
    if (!token) return true;

    try {
        // 1. Split the token (Header.Payload.Signature)
        const base64Url = token.split('.')[1];

        // 2. Normalize Base64Url to Base64
        const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');

        // 3. Decode the payload
        const jsonPayload = decodeURIComponent(
            atob(base64)
                .split('')
                .map((c) => '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2))
                .join('')
        );

        const { exp } = JSON.parse(jsonPayload);

        // 4. Check if expired (exp is in seconds, Date.now is in ms)
        if (!exp) return false; // If no expiry, assume valid
        return Date.now() >= exp * 1000;

    } catch (error) {
        console.error("Error checking token expiration:", error);
        return true; // Treat invalid format as expired
    }
}
</file>

<file path="src/lib/utils.ts">
import { clsx, type ClassValue } from "clsx"
import { twMerge } from "tailwind-merge"

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}
</file>

<file path="src/main.tsx">
import { createRoot } from 'react-dom/client'
import './index.css'
import App from './App.tsx'
import { ThemeProvider } from "@/shared/components/provider/ThemeProvider.tsx";

createRoot(document.getElementById('root')!).render(
    <ThemeProvider>
        <App />
    </ThemeProvider>
)
</file>

<file path="src/shared/components/provider/ThemeProvider.tsx">
import { useEffect } from "react"
import { useThemeStore } from "@/store/themeStore.ts"
import * as React from "react";

export function ThemeProvider({ children }: { children: React.ReactNode }) {
    const theme = useThemeStore((state) => state.theme)

    useEffect(() => {
        const root = window.document.documentElement
        root.classList.remove("light", "dark")
        root.classList.add(theme)
    }, [theme])

    return <>{children}</>
}
</file>

<file path="src/shared/components/RequireAuth.tsx">
// src/components/RequireAuth.tsx (Create this file)
import { useAuthStore } from "@/store/authStore.ts";
import { Redirect } from "wouter";
import type { ReactNode } from "react";

export function RequireAuth({ children }: { children: ReactNode }) {
    const isAuthenticated = useAuthStore((state) => state.isAuthenticated);

    if (!isAuthenticated) {
        return <Redirect to="/" />;
    }

    return <>{children}</>;
}
</file>

<file path="src/shared/components/sidebar/AppSidebar.tsx">
import * as React from "react"
import { NavMain } from "@/shared/components/sidebar/NavMain.tsx"
import { NavUser } from "@/shared/components/sidebar/NavUser.tsx"
import { Sidebar, SidebarContent, SidebarFooter, SidebarHeader, SidebarRail, } from "@/components/ui/sidebar.tsx"
import { sidebarConfig } from "@/config/sidebar.config.ts"
import { SidebarBrand } from "@/shared/components/sidebar/SidebarBrand.tsx";

export function AppSidebar({ ...props }: React.ComponentProps<typeof Sidebar>) {
    return (
        <Sidebar collapsible="icon" {...props}>
            <SidebarHeader>
                <SidebarBrand/>
            </SidebarHeader>
            <SidebarContent>
                <NavMain items={sidebarConfig.navMain}/>
            </SidebarContent>
            <SidebarFooter>
                <NavUser/>
            </SidebarFooter>
            <SidebarRail/>
        </Sidebar>
    )
}
</file>

<file path="src/shared/components/sidebar/NavMain.tsx">
import { MoreHorizontal } from "lucide-react"
import { Link, useLocation } from "wouter"
import { useAuthStore } from "@/store/authStore"
import {
    DropdownMenu,
    DropdownMenuContent,
    DropdownMenuItem,
    DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu"
import {
    SidebarGroup,
    SidebarMenu,
    SidebarMenuButton,
    SidebarMenuItem,
    useSidebar,
} from "@/components/ui/sidebar"
import type { NavItem } from "@/config/sidebar.config.ts"

export function NavMain({ items }: { items: NavItem[] }) {
    const { isMobile } = useSidebar()
    const [location] = useLocation()
    const { user } = useAuthStore() // 2. Get User

    // 3. Filter Logic
    const filteredItems = items.filter(item => {
        // If no roles defined, everyone can see
        if (!item.allowedRoles) return true;
        // If roles defined, check if user has one of them
        return user && item.allowedRoles.includes(user.role);
    });

    return (
        <SidebarGroup>
            <SidebarMenu>
                {filteredItems.map((item) => { // 4. Map the filtered list
                    const isActive = location === item.url || item.items?.some(sub => sub.url === location)

                    return (
                        <SidebarMenuItem key={item.title}>
                            {item.items?.length ? (
                                <DropdownMenu>
                                    <DropdownMenuTrigger asChild>
                                        <SidebarMenuButton
                                            isActive={isActive}
                                            tooltip={item.title}
                                        >
                                            {item.icon && <item.icon />}
                                            <span>{item.title}</span>
                                            <MoreHorizontal className="ml-auto" />
                                        </SidebarMenuButton>
                                    </DropdownMenuTrigger>
                                    <DropdownMenuContent
                                        side={isMobile ? "bottom" : "right"}
                                        align={isMobile ? "end" : "start"}
                                        className="min-w-56 rounded-lg"
                                    >
                                        {item.items.map((subItem) => (
                                            <DropdownMenuItem asChild key={subItem.title}>
                                                <Link href={subItem.url} className="cursor-pointer">
                                                    {subItem.title}
                                                </Link>
                                            </DropdownMenuItem>
                                        ))}
                                    </DropdownMenuContent>
                                </DropdownMenu>
                            ) : (
                                <SidebarMenuButton
                                    asChild
                                    isActive={isActive}
                                    tooltip={item.title}
                                >
                                    <Link href={item.url}>
                                        {item.icon && <item.icon />}
                                        <span>{item.title}</span>
                                    </Link>
                                </SidebarMenuButton>
                            )}
                        </SidebarMenuItem>
                    )
                })}
            </SidebarMenu>
        </SidebarGroup>
    )
}
</file>

<file path="src/shared/components/sidebar/NavUser.tsx">
import {
    BadgeCheck,
    Bell,
    ChevronsUpDown,
    LogOut,
    Moon,
    Sun,
} from "lucide-react"
import { Avatar, AvatarFallback, AvatarImage } from "@/components/ui/avatar.tsx"
import {
    DropdownMenu,
    DropdownMenuContent,
    DropdownMenuGroup,
    DropdownMenuItem,
    DropdownMenuLabel,
    DropdownMenuSeparator,
    DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu.tsx"
import {
    SidebarMenu,
    SidebarMenuButton,
    SidebarMenuItem,
    useSidebar,
} from "@/components/ui/sidebar.tsx"
import { useAuthStore } from "@/store/authStore.ts"
import { useThemeStore } from "@/store/themeStore.ts"

export function NavUser() {
    const { isMobile } = useSidebar()
    const { user, logout } = useAuthStore()
    const { theme, toggleTheme } = useThemeStore()

    if (!user) return null

    return (
        <SidebarMenu>
            <SidebarMenuItem>
                <DropdownMenu>
                    <DropdownMenuTrigger asChild>
                        <SidebarMenuButton
                            size="lg"
                            className="data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground"
                        >
                            <Avatar className="h-8 w-8 rounded-lg">
                                <AvatarImage src={`https://avatar.vercel.sh/${user.email}`} alt={user.name} />
                                <AvatarFallback className="rounded-lg">{user.name.substring(0, 2).toUpperCase()}</AvatarFallback>
                            </Avatar>
                            <div className="grid flex-1 text-left text-sm leading-tight">
                                <span className="truncate font-semibold">{user.name}</span>
                                <span className="truncate text-xs">{user.email}</span>
                            </div>
                            <ChevronsUpDown className="ml-auto size-4" />
                        </SidebarMenuButton>
                    </DropdownMenuTrigger>
                    <DropdownMenuContent
                        className="w-(--radix-dropdown-menu-trigger-width) min-w-56 rounded-lg"
                        side={isMobile ? "bottom" : "right"}
                        align="end"
                        sideOffset={4}
                    >
                        <DropdownMenuLabel className="p-0 font-normal">
                            <div className="flex items-center gap-2 px-1 py-1.5 text-left text-sm">
                                <Avatar className="h-8 w-8 rounded-lg">
                                    <AvatarFallback className="rounded-lg">{user.name.substring(0, 2).toUpperCase()}</AvatarFallback>
                                </Avatar>
                                <div className="grid flex-1 text-left text-sm leading-tight">
                                    <span className="truncate font-semibold">{user.name}</span>
                                    <span className="truncate text-xs">{user.email}</span>
                                </div>
                            </div>
                        </DropdownMenuLabel>
                        <DropdownMenuSeparator />
                        <DropdownMenuGroup>
                            {/* Theme Toggle */}
                            <DropdownMenuItem onClick={toggleTheme} className="cursor-pointer">
                                {theme === "light" ? <Moon className="mr-2 size-4" /> : <Sun className="mr-2 size-4" />}
                                <span>{theme === "light" ? "Dark Mode" : "Light Mode"}</span>
                            </DropdownMenuItem>
                        </DropdownMenuGroup>
                        <DropdownMenuSeparator />
                        <DropdownMenuGroup>
                            <DropdownMenuItem>
                                <BadgeCheck className="mr-2 size-4" />
                                Account
                            </DropdownMenuItem>
                            <DropdownMenuItem>
                                <Bell className="mr-2 size-4" />
                                Notifications
                            </DropdownMenuItem>
                        </DropdownMenuGroup>
                        <DropdownMenuSeparator />
                        <DropdownMenuItem onClick={logout} className="text-destructive focus:text-destructive cursor-pointer">
                            <LogOut className="mr-2 size-4" />
                            Log out
                        </DropdownMenuItem>
                    </DropdownMenuContent>
                </DropdownMenu>
            </SidebarMenuItem>
        </SidebarMenu>
    )
}
</file>

<file path="src/shared/components/sidebar/SidebarBrand.tsx">
import { SidebarMenu, SidebarMenuButton, SidebarMenuItem } from "@/components/ui/sidebar";
import { sidebarConfig } from "@/config/sidebar.config";

export function SidebarBrand() {
    return (
        <SidebarMenu>
            <SidebarMenuItem>
                <SidebarMenuButton size="lg" asChild>
                    <a href="/home">
                        <div className="bg-sidebar-primary text-sidebar-primary-foreground flex aspect-square size-8 items-center justify-center rounded-lg">
                            <sidebarConfig.brand.logo className="size-4" />
                        </div>
                        <div className="flex flex-col gap-0.5 leading-none">
                            <span className="font-semibold">{sidebarConfig.brand.name}</span>
                            <span className="text-xs text-muted-foreground">{sidebarConfig.brand.plan}</span>
                        </div>
                    </a>
                </SidebarMenuButton>
            </SidebarMenuItem>
        </SidebarMenu>
    );
}
</file>

<file path="src/shared/components/ui/GenericTable.tsx">
import {
    type ColumnDef,
    flexRender,
    getCoreRowModel,
    getPaginationRowModel,
    useReactTable,
} from "@tanstack/react-table";

import { Table, TableBody, TableCell, TableHead, TableHeader, TableRow, } from "@/components/ui/table";
import { Button } from "@/components/ui/button";
import { Skeleton } from "@/components/ui/skeleton";

interface GenericTableProps<TData, TValue> {
    columns: ColumnDef<TData, TValue>[];
    data: TData[];
    isLoading?: boolean;
}

export function GenericTable<TData, TValue>({
                                                columns,
                                                data,
                                                isLoading
                                            }: GenericTableProps<TData, TValue>) {
    const table = useReactTable({
        data,
        columns,
        getCoreRowModel: getCoreRowModel(),
        getPaginationRowModel: getPaginationRowModel(),
    });

    return (
        <div className="space-y-4">
            <div className="rounded-md border shadow-sm">
                <Table>
                    <TableHeader>
                        {table.getHeaderGroups().map((headerGroup) => (
                            <TableRow key={headerGroup.id}>
                                {headerGroup.headers.map((header) => {
                                    return (
                                        <TableHead key={header.id}>
                                            {header.isPlaceholder
                                                ? null
                                                : flexRender(
                                                    header.column.columnDef.header,
                                                    header.getContext()
                                                )}
                                        </TableHead>
                                    );
                                })}
                            </TableRow>
                        ))}
                    </TableHeader>
                    <TableBody>
                        {isLoading ? (
                            /* Loading State */
                            Array.from({ length: 5 }).map((_, i) => (
                                <TableRow key={i}>
                                    {columns.map((_col, j) => (
                                        <TableCell key={j}><Skeleton className="h-6 w-full"/></TableCell>
                                    ))}
                                </TableRow>
                            ))
                        ) : table.getRowModel().rows?.length ? (
                            table.getRowModel().rows.map((row) => (
                                <TableRow
                                    key={row.id}
                                    data-state={row.getIsSelected() && "selected"}
                                >
                                    {row.getVisibleCells().map((cell) => (
                                        <TableCell key={cell.id}>
                                            {flexRender(
                                                cell.column.columnDef.cell,
                                                cell.getContext()
                                            )}
                                        </TableCell>
                                    ))}
                                </TableRow>
                            ))
                        ) : (
                            <TableRow>
                                <TableCell
                                    colSpan={columns.length}
                                    className="h-24 text-center"
                                >
                                    Nenhum registro encontrado.
                                </TableCell>
                            </TableRow>
                        )}
                    </TableBody>
                </Table>
            </div>

            {/* Pagination Controls */}
            <div className="flex items-center justify-end space-x-2 py-4">
                <Button
                    variant="outline"
                    size="sm"
                    onClick={() => table.previousPage()}
                    disabled={!table.getCanPreviousPage()}
                >
                    Anterior
                </Button>
                <Button
                    variant="outline"
                    size="sm"
                    onClick={() => table.nextPage()}
                    disabled={!table.getCanNextPage()}
                >
                    Prximo
                </Button>
            </div>
        </div>
    );
}
</file>

<file path="src/shared/layouts/DashboardLayout.tsx">
import { AppSidebar } from "@/shared/components/sidebar/AppSidebar.tsx"
import { Separator } from "@/components/ui/separator"
import {
    SidebarInset,
    SidebarProvider,
    SidebarTrigger,
} from "@/components/ui/sidebar"
import type { ReactNode } from "react"

export default function DashboardLayout({ children }: { children: ReactNode }) {
    return (
        <SidebarProvider>
            <AppSidebar />
            <SidebarInset>
                <header className="flex h-16 shrink-0 items-center gap-2 transition-[width,height] ease-linear group-has-[[data-collapsible=icon]]/sidebar-wrapper:h-12 border-b px-4">
                    <div className="flex items-center gap-2">
                        <SidebarTrigger className="-ml-1" />
                        <Separator orientation="vertical" className="mr-2 h-4" />
                        {/* Add Breadcrumbs here if needed */}
                    </div>
                </header>
                <main className="flex flex-1 flex-col gap-4 p-4 pt-0 mt-4">
                    {children}
                </main>
            </SidebarInset>
        </SidebarProvider>
    )
}
</file>

<file path="src/shared/pages/HomePage.tsx">
import DashboardLayout from "@/shared/layouts/DashboardLayout.tsx";

function HomePage() {
    return (
        <DashboardLayout>
            <div className="grid auto-rows-min gap-4 md:grid-cols-3">
                <div className="bg-muted/50 aspect-video rounded-xl" />
                <div className="bg-muted/50 aspect-video rounded-xl" />
                <div className="bg-muted/50 aspect-video rounded-xl" />
            </div>
            <div className="bg-muted/50 min-h-[50vh] flex-1 rounded-xl p-6">
                <h2 className="text-2xl font-bold tracking-tight">Welcome back!</h2>
                <p className="text-muted-foreground">
                    Start managing your ESG data using the sidebar menu.
                </p>
            </div>
        </DashboardLayout>
    )
}

export default HomePage;
</file>

<file path="src/shared/pages/LoginPage.tsx">
import { useEffect } from "react";
import { useLocation } from "wouter";
import { useAuthStore } from "@/store/authStore.ts";
import LoginCard from "@/features/auth/components/LoginCard.tsx";

function LoginPage() {
    // 1. Listen to the authentication state
    const isAuthenticated = useAuthStore((state) => state.isAuthenticated);

    // 2. Get the navigation function from Wouter
    const [, setLocation] = useLocation();

    // 3. React to state changes
    useEffect(() => {
        if (isAuthenticated) {
            setLocation("/home");
        }
    }, [isAuthenticated, setLocation]);

    // 4. Optional: Prevent "flash" of login form while redirecting
    if (isAuthenticated) {
        return null;
    }

    return (
        <main className="flex h-full w-full flex-col items-center justify-center px-4 text-center">
            <LoginCard />
        </main>
    );
}

export default LoginPage;
</file>

<file path="src/shared/pages/ManagerPage.tsx">
import { useMemo, useState } from 'react';
import { Link, useParams } from 'wouter';
import { useAuthStore } from '@/store/authStore';
import { type ManagerType, useManagerConfig } from '@/features/managers/hooks/useManagerConfig';
import { useManagerData } from '@/features/managers/hooks/useManagerData';
import { useManagerMutations } from '@/features/managers/hooks/useManagerMutation';

import { Button } from '@/components/ui/button';
import { Plus, ShieldAlert } from 'lucide-react';
import { GenericTable } from '@/shared/components/ui/GenericTable';
import { generateColumns } from '@/features/managers/components/ManagerColumns';
import { ManagerAccordion } from '@/features/managers/components/ManagerAccordion';

export default function ManagerPage() {
    const { type } = useParams<{ type: string }>();
    const { user } = useAuthStore();

    // 1. Load Strategy (Brain)
    const config = useManagerConfig(type as ManagerType, user);

    // 2. Fetch Data (Heart)
    const { data, isLoading: isDataLoading, isError, deleteItem } = useManagerData(type as ManagerType);

    // 3. UI State
    const [isFormOpen, setIsFormOpen] = useState(false);
    const [selectedItem, setSelectedItem] = useState<any>(null);

    // 4. Mutations (Hands)
    // We close the form automatically on success
    const { createItem, updateItem, isSaving } = useManagerMutations(
        type as ManagerType,
        () => {
            setIsFormOpen(false);
            setSelectedItem(null);
        }
    );

    // 5. Handlers
    const handleCreate = () => {
        // If form is already open in "Create" mode, close it. Otherwise open it.
        if (isFormOpen && !selectedItem) {
            setIsFormOpen(false);
        } else {
            setSelectedItem(null); // Clear selection for create mode
            setIsFormOpen(true);
        }
    };

    const handleEdit = (item: any) => {
        setSelectedItem(item); // Set item for edit mode
        setIsFormOpen(true);   // Expand accordion

        // Smooth scroll to top to show the form
        window.scrollTo({ top: 0, behavior: 'smooth' });
    };

    const handleDelete = async (item: any) => {
        if (confirm(`Tem certeza que deseja excluir: ${item.name || item.description || 'este item'}?`)) {
            await deleteItem(item.id);
        }
    };

    const handleSubmit = async (formData: any) => {
        const { company, unit, children, parent, id, ...cleanData } = formData;

        if (selectedItem) {
            // Update Mode
            await updateItem({ id: selectedItem.id, data: cleanData });
        } else {
            // Create Mode
            await createItem(cleanData);
        }
    };

    // const handleCancel = () => {
    //     setIsFormOpen(false);
    //     setSelectedItem(null);
    // }

    // 6. Generate Columns
    const tableColumns = useMemo(() =>
            generateColumns(config.columns, handleEdit, handleDelete),
        [config.columns, deleteItem]
    );

    // --- RENDER ---

    // Security Gate
    if (!config.isAllowed) {
        return (
            <div className="flex flex-col items-center justify-center h-[50vh] text-center space-y-4">
                <div className="bg-red-100 p-4 rounded-full">
                    <ShieldAlert className="size-10 text-red-600" />
                </div>
                <h2 className="text-xl font-semibold text-gray-900">Acesso Restrito</h2>
                <p className="text-muted-foreground">Voc no tem permisso para acessar este mdulo.</p>
                <Link href="/home">
                    <Button variant="outline">Voltar para Dashboard</Button>
                </Link>
            </div>
        );
    }

    // API Error
    if (isError) {
        return <div className="p-8 text-center text-red-500">Erro ao carregar dados. Verifique sua conexo.</div>;
    }

    return (
        <div className="space-y-6">
            {/* HEADER */}
            <div className="flex justify-between items-center">
                <div>
                    <h1 className="text-2xl font-bold tracking-tight">{config.title}</h1>
                    <p className="text-muted-foreground">{config.description}</p>
                </div>

                {/* Toggle Button */}
                {!isFormOpen && (
                    <Button
                        onClick={handleCreate}
                        variant={isFormOpen && !selectedItem ? "secondary" : "default"}
                    >
                        <>
                            <Plus className="mr-2 size-4" /> Novo Registro
                        </>
                    </Button>
                )}
            </div>

            {/* ACCORDION FORM */}
            <ManagerAccordion
                isOpen={isFormOpen}
                setIsOpen={(open) => {
                    setIsFormOpen(open);
                    if (!open) setSelectedItem(null); // Clear selection on close
                }}
                fields={config.fields}
                initialData={selectedItem}
                onSubmit={handleSubmit}
                isLoading={isSaving}
            />

            {/* DATA TABLE */}
            <GenericTable
                columns={tableColumns}
                data={data}
                isLoading={isDataLoading}
            />
        </div>
    );
}
</file>

<file path="src/store/authStore.ts">
import type { User } from "@/types/User.ts";
import { create } from 'zustand';
import { createJSONStorage, persist } from "zustand/middleware";
import { isTokenExpired } from "@/lib/authUtils.ts";

interface AuthState {
    token: string | null;
    user: User | null;
    isAuthenticated: boolean;
    login: (token: string, user: User) => void;
    logout: () => void;
    checkSession: () => void;
}

export const useAuthStore = create<AuthState>()(
    persist(
        (set, get) => ({
            token: null,
            user: null,
            isAuthenticated: false,
            login: (token, user) => set({ token, user, isAuthenticated: true }),
            logout: () => set({ token: null, user: null, isAuthenticated: false }),

            checkSession: () => {
                const { token, logout } = get();
                if (!token || isTokenExpired(token)) {
                    logout();
                }
            }
        }),
        {
            name: 'auth-storage',
            storage: createJSONStorage(() => localStorage),
        }
    )
)
</file>

<file path="src/store/themeStore.ts">
import { create } from 'zustand'
import { persist, createJSONStorage } from 'zustand/middleware'

interface ThemeState {
    theme: 'light' | 'dark'
    setTheme: (theme: 'light' | 'dark') => void
    toggleTheme: () => void
}

export const useThemeStore = create<ThemeState>()(
    persist(
        (set) => ({
            theme: 'light',
            setTheme: (theme) => set({ theme }),
            toggleTheme: () => set((state) => ({
                theme: state.theme === 'light' ? 'dark' : 'light'
            })),
        }),
        {
            name: 'theme-storage', // key in localStorage
            storage: createJSONStorage(() => localStorage),
        }
    )
)
</file>

<file path="src/types/AssetTypology.ts">
import type { ReportingFrequency } from "@/types/enums.ts";
import type { Unit } from "@/types/Unit.ts";

export interface AssetTypology {
    id: number;
    unitId: number;
    sourceType: string;
    description: string;
    assetFields: string; // JSON string
    isActive: boolean;
    responsibleContactId: number | null;
    reportingFrequency: ReportingFrequency;
    unit?: Unit;
}
</file>

<file path="src/types/Company.ts">
import type { User } from "./User";
import type { Unit } from "@/types/Unit.ts";

export interface Company {
    id: string;
    name: string;
    cnpj: string | null;
    createdAt: Date;
    // Relations
    users?: User[];
    units?: Unit[];
}
</file>

<file path="src/types/enums.ts">
export type UserRole = 'MASTER' | 'ADMIN' | 'USER';
export type ReportingFrequency = 'anual' | 'mensal';
</file>

<file path="src/types/EsgData.ts">
import type { Unit } from "@/types/Unit.ts";

interface BaseEsgData {
    id: number;
    year: number;
    period: string;
    unitId: number;
    comments: string | null;
    createdAt: Date;
    updatedAt: Date;

    // Relations
    unit?: Unit;

    // Common Responsibility Fields (Present in most, but not all. Optional here)
    responsible?: string | null;
    deptResponsible?: string | null;
    email?: string | null;
    phone?: string | null;
}

// 1. Mobile Combustion
export interface MobileCombustionData extends BaseEsgData {
    sourceDescription: string | null;
    isCompanyControlled: boolean;
    inputType: string | null;
    fuelType: string | null;
    consumption: number | null;
    consumptionUnit: string | null;
    distance: number | null;
    distanceUnit: string | null;
    vehicleType: string | null;
}

// 2. Stationary Combustion
export interface StationaryCombustionData extends BaseEsgData {
    sourceDescription: string | null;
    fuelType: string | null;
    consumption: number | null;
    unitMeasure: string | null;
    isCompanyControlled: boolean;
}

// 3. Production & Sales
export interface ProductionSalesData extends BaseEsgData {
    product: string;
    quantitySold: number;
    measureUnit: string;
}

// 4. Lubricants & IPPU
export interface LubricantsIppuData extends BaseEsgData {
    emissionSource: string | null;
    lubricantType: string | null;
    consumption: number | null;
    unitMeasure: string | null;
    isCompanyControlled: boolean;
}

// 5. Fugitive Emissions
export interface FugitiveEmissionsData extends BaseEsgData {
    emissionSource: string | null;
    gasType: string | null;
    quantityReplaced: number | null;
    unitMeasure: string | null;
    isCompanyControlled: boolean;
}

// 6. Fertilizers
export interface FertilizersData extends BaseEsgData {
    fertilizerType: string | null;
    quantityKg: number | null;
    unitMeasure: string | null;
    percentNitrogen: number | null;
    percentCarbonate: number | null;
    isCompanyControlled: boolean;
}

// 7. Controlled Effluents
export interface EffluentsControlledData extends BaseEsgData {
    treatmentOrDest: string;
    treatmentType: string | null;
    finalDestType: string | null;
    qtyEffluentM3: number;
    unitEffluent: string;
    qtyOrganic: number;
    unitOrganic: string;
    qtyNitrogen: number;
    unitNitrogen: string;
    organicRemovedSludge: number | null;
    unitSludge: string | null;
}

// 8. Domestic Effluents
export interface DomesticEffluentsData extends BaseEsgData {
    workerType: string;
    numWorkers: number;
    avgWorkHours: number;
    septicTankOwner: string;
}

// 9. Land Use Change
export interface LandUseChangeData extends BaseEsgData {
    prevLandUse: string;
    biome: string | null;
    phytophysiognomy: string | null;
    areaType: string | null;
    areaHectares: number;
}

// 10. Solid Waste
export interface SolidWasteData extends BaseEsgData {
    finalDestination: string | null;
    wasteType: string | null;
    quantityGenerated: number | null;
    unitMeasure: string | null;
    cityStateDest: string | null;
    locationControlled: string | null;
    internalTracking: string | null;
}

// 11. Electricity Purchase
export interface ElectricityPurchaseData extends BaseEsgData {
    energySource: string | null;
    specifySource: string | null;
    consumption: number | null;
    measureUnit: string | null;
    traceability: string | null;
}

// 12. Purchased Goods & Services
export interface PurchasedGoodsServicesData extends BaseEsgData {
    itemDescription: string | null;
    itemType: string | null;
    quantity: number | null;
    unitMeasure: string | null;
    acquisitionValue: number | null;
    thirdPartyGoods: string | null;
}

// 13. Capital Goods
export interface CapitalGoodsData extends BaseEsgData {
    capitalGood: string | null;
    quantity: number | null;
    unitMeasure: string | null;
    acquisitionValue: number | null;
}

// 14. Upstream Transport
export interface UpstreamTransportData extends BaseEsgData {
    transportedItem: string | null;
    transportMode: string | null;
    reportType: string | null;
    fuel: string | null;
    consumption: number | null;
    consumptionUnit: string | null;
    vehicleClass: string | null;
    distance: number | null;
    distanceUnit: string | null;
    transportedLoad: number | null;
    tripCount: number | null;
    origin: string | null;
    destination: string | null;
}

// 15. Business Travel (Land)
export interface BusinessTravelLandData extends BaseEsgData {
    tripDescription: string | null;
    travelMode: string | null;
    reportType: string | null;
    fuel: string | null;
    consumption: number | null;
    consumptionUnit: string | null;
    distance: number | null;
    distanceUnit: string | null;
    kmReimbursed: string | null;
}

// 16. Downstream Transport
// (Identical to Upstream in structure, separated for domain clarity)
export interface DownstreamTransportData extends UpstreamTransportData {}

// 17. Waste Transport
export interface WasteTransportData extends BaseEsgData {
    transportedItem: string | null;
    reportType: string | null;
    fuel: string | null;
    consumption: number | null;
    consumptionUnit: string | null;
    vehicleClass: string | null;
    distance: number | null;
    distanceUnit: string | null;
    transportedLoad: number | null;
    tripCount: number | null;
}

// 18. Home Office
export interface HomeOfficeData extends BaseEsgData {
    workRegime: string | null;
    numEmployees: number | null;
}

// 19. Air Travel
export interface AirTravelData extends BaseEsgData {
    tripDescription: string | null;
    airportCodeOrigin: string | null;
    airportCodeDest: string | null;
    tripCount: number | null;
}

// 20. Employee Commuting
export interface EmployeeCommutingData extends BaseEsgData {
    identifier: string | null;
    methodUsed: string | null;
    reportType: string | null;
    fuelType: string | null;
    consumption: number | null;
    consumptionUnit: string | null;
    distanceKm: number | null;
    employeeAddress: string | null;
    workAddress: string | null;
    daysCommuted: number | null;
}

// 21. Energy Generation
export interface EnergyGenerationData extends BaseEsgData {
    sourceDescription: string | null;
    generationSource: string | null;
    totalGeneration: number | null;
    measureUnit: string | null;
}

// 22. Planted Forest
export interface PlantedForestData extends BaseEsgData {
    areaId: string | null;
    speciesName: string | null;
    areaPrePreLast: number | null;
    agePrePreLast: number | null;
    agePreLast: number | null;
    areaHarvestedPreLast: number | null;
    currentArea: number | null;
}

// 23. Conservation Area
export interface ConservationAreaData extends BaseEsgData {
    description: string | null;
    biome: string | null;
    phytophysiognomy: string | null;
    plantedArea: string | null;
    plantingStatus: string | null;
    areaStartYear: number | null;
    areaEndYear: number | null;
    changeReason: string | null;
}
</file>

<file path="src/types/ManagedOptions.ts">
export interface ManagedOption {
    id: number;
    fieldKey: string;
    value: string;
}
</file>

<file path="src/types/Unit.ts">
import type { AssetTypology } from "./AssetTypology";
import type { Company } from "./Company";
import type { User } from "@/types/User.ts";
import type {
    AirTravelData,
    BusinessTravelLandData,
    CapitalGoodsData,
    ConservationAreaData, DomesticEffluentsData, DownstreamTransportData, EffluentsControlledData,
    ElectricityPurchaseData, EmployeeCommutingData,
    EnergyGenerationData,
    FertilizersData,
    FugitiveEmissionsData, HomeOfficeData, LandUseChangeData,
    LubricantsIppuData,
    MobileCombustionData, PlantedForestData, ProductionSalesData, PurchasedGoodsServicesData, SolidWasteData,
    StationaryCombustionData, UpstreamTransportData, WasteTransportData
} from "./EsgData";

export interface Unit {
    id: number;
    name: string;
    city: string;
    state: string;
    country: string;
    numberOfWorkers: number;

    // Foreign Keys
    companyId: string;

    // Parent Relations (Upwards)
    company?: Company;

    // Child Relations (Downwards - Users)
    users?: User[];

    // --- ESG DATA RELATIONS (Downwards - Data) ---
    // These are optional arrays because you might not include them in every Prisma query.

    assetTypologies?: AssetTypology[];

    // Scope 1 & 2
    mobileCombustionDatas?: MobileCombustionData[];
    stationaryCombustionDatas?: StationaryCombustionData[];
    fugitiveEmissionsDatas?: FugitiveEmissionsData[];
    lubricantsIppuDatas?: LubricantsIppuData[];
    fertilizersDatas?: FertilizersData[];
    energyGenerationDatas?: EnergyGenerationData[];
    electricityPurchaseDatas?: ElectricityPurchaseData[];
    landUseChangeDatas?: LandUseChangeData[];
    plantedForestDatas?: PlantedForestData[];
    conservationAreaDatas?: ConservationAreaData[];

    // Scope 3 & Value Chain
    productionSalesDatas?: ProductionSalesData[];
    purchasedGoodsServicesDatas?: PurchasedGoodsServicesData[];
    capitalGoodsDatas?: CapitalGoodsData[];
    upstreamTransportDatas?: UpstreamTransportData[];
    downstreamTransportDatas?: DownstreamTransportData[];
    businessTravelLandDatas?: BusinessTravelLandData[];
    airTravelDatas?: AirTravelData[];
    employeeCommutingDatas?: EmployeeCommutingData[];
    wasteTransportDatas?: WasteTransportData[];
    homeOfficeDatas?: HomeOfficeData[];

    // Waste & Effluents
    solidWasteDatas?: SolidWasteData[];
    effluentsControlledDatas?: EffluentsControlledData[];
    domesticEffluentsDatas?: DomesticEffluentsData[];

    createdAt: Date;
}
</file>

<file path="src/types/User.ts">
import type { Company } from "@/types/Company.ts";
import type { UserRole } from "@/types/enums.ts";
import type { Unit } from "@/types/Unit.ts";

export interface User {
    id: string;
    email: string;
    name: string;
    phone: string | null;
    role: UserRole;

    // Multi-tenancy & Hierarchy
    companyId: string | null;
    unitId: number | null;
    parentId: string | null;

    // Relations
    company?: Company | null;
    unit?: Unit | null;
    parent?: User | null;
    children?: User[];
    permissions?: UserPermission[];

    createdAt: Date;
    updatedAt: Date;
}

export interface UserPermission {
    id: string;
    userId: string;
    sourceType: string;
    user?: User;
}
</file>

<file path="tsconfig.app.json">
{
  "compilerOptions": {
    "tsBuildInfoFile": "./node_modules/.tmp/tsconfig.app.tsbuildinfo",
    "target": "ES2022",
    "useDefineForClassFields": true,
    "lib": [
      "ES2022",
      "DOM",
      "DOM.Iterable"
    ],
    "module": "ESNext",
    "types": [
      "vite/client"
    ],
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "verbatimModuleSyntax": true,
    "moduleDetection": "force",
    "noEmit": true,
    "jsx": "react-jsx",

    /* Linting */
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "erasableSyntaxOnly": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedSideEffectImports": true,

    "baseUrl": ".",
    "paths": {
      "@/*": [
        "./src/*"
      ]
    }
  },
  "include": [
    "src"
  ]
}
</file>

<file path="tsconfig.json">
{
  "files": [],
  "references": [
    {
      "path": "./tsconfig.app.json"
    },
    {
      "path": "./tsconfig.node.json"
    }
  ],
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@/*": [
        "./src/*"
      ]
    }
  }
}
</file>

<file path="tsconfig.node.json">
{
  "compilerOptions": {
    "tsBuildInfoFile": "./node_modules/.tmp/tsconfig.node.tsbuildinfo",
    "target": "ES2023",
    "lib": ["ES2023"],
    "module": "ESNext",
    "types": ["node"],
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "verbatimModuleSyntax": true,
    "moduleDetection": "force",
    "noEmit": true,

    /* Linting */
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "erasableSyntaxOnly": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedSideEffectImports": true
  },
  "include": ["vite.config.ts"]
}
</file>

<file path="vite.config.ts">
import path from "path"
import tailwindcss from "@tailwindcss/vite"
import react from "@vitejs/plugin-react"
import { defineConfig } from "vite"

// https://vite.dev/config/
export default defineConfig({
  plugins: [react(), tailwindcss()],
  resolve: {
    alias: {
      "@": path.resolve(__dirname, "./src"),
    },
  },
})
</file>

</files>
